{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/user/UserHistory.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/user/UserHistory.vue","mtime":1665531625452},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/babel.config.js","mtime":1665531625438},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js","mtime":1665531751248},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHJ1bGVzIGZyb20gIkAvdXRpbHMvcnVsZXMiOwppbXBvcnQgVXNlckFwaSBmcm9tICJAL2FwaS9Vc2VyQXBpIjsKaW1wb3J0IGNvbmZpZyBmcm9tICJAL2NvbmZpZ3MiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ3VzZXJIaXN0b3J5JywKICBwcm9wczogWydpZCddLAogIGNvbXBvbmVudHM6IHt9LAogIGRhdGE6ICgpID0+ICh7CiAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgaGVhZGVyczogW3sKICAgICAgdGV4dDogJ+ydvOugqCDrsojtmLgnLAogICAgICBhbGlnbjogJ2xlZnQnLAogICAgICB2YWx1ZTogJ25vJwogICAgfSwgewogICAgICB0ZXh0OiAn7J2066ClIOuyiO2YuCcsCiAgICAgIGFsaWduOiAnbGVmdCcsCiAgICAgIHZhbHVlOiAnaWQnCiAgICB9LCB7CiAgICAgIHRleHQ6ICfsiJjsoJXsnpAg67KI7Zi4JywKICAgICAgYWxpZ246ICdsZWZ0JywKICAgICAgdmFsdWU6ICdmcm9tSWQnCiAgICB9LCB7CiAgICAgIHRleHQ6ICftmZzrj5kg64K07JetJywKICAgICAgYWxpZ246ICdsZWZ0JywKICAgICAgdmFsdWU6ICd1c2VyQWN0aW9uJwogICAgfSwgewogICAgICB0ZXh0OiAn7JWE7J207ZS8JywKICAgICAgdmFsdWU6ICdpcCcKICAgIH0sIHsKICAgICAgdGV4dDogJ+2ZnOuPmSDsnbzsi5wnLAogICAgICB2YWx1ZTogJ2NyZWF0ZWRBdCcKICAgIH0sIHsKICAgICAgdGV4dDogJycsCiAgICAgIHZhbHVlOiAnZGF0YS10YWJsZS1leHBhbmQnCiAgICB9CiAgICAvLyB7dGV4dDogJ+q0gOumrCcsIHNvcnRhYmxlOiBmYWxzZSwgdmFsdWU6ICdhY3Rpb25zJ30KICAgIF0sCgogICAgb3B0aW9uczoge30sCiAgICBwYXJhbTogewogICAgICBzZWFyY2hLZXl3b3JkOiBudWxsLAogICAgICBwYWdlOiAxCiAgICB9LAogICAgdG90YWxJdGVtczogMCwKICAgIGxpc3RMaW5rOiAnL3VzZXJzJywKICAgIHJ1bGVzLAogICAgc3RhdGVzOiBjb25maWcubWV0YS51c2VyLnN0YXRlLAogICAgc3lzdGVtczogY29uZmlnLm1ldGEuc3lzdGVtcywKICAgIG1lc3NhZ2U6IHsKICAgICAgZXJyb3I6ICcnLAogICAgICBlcnJvckVtYWlsOiAnJywKICAgICAgZXJyb3JTeXN0ZW06IG51bGwsCiAgICAgIHN1Y2Nlc3M6ICcnLAogICAgICBzdWNjZXNzRW1haWw6ICcnCiAgICB9LAogICAgaGlzdG9yeUxpc3Q6IFtdCiAgfSksCiAgd2F0Y2g6IHsKICAgIG9wdGlvbnM6IHsKICAgICAgaGFuZGxlcigpIHsKICAgICAgICB0aGlzLmdldEhpc3RvcnkoKTsKICAgICAgfSwKICAgICAgZGVlcDogdHJ1ZQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIG1ldGhvZHM6IHsKICAgIGdldEhpc3Rvcnkoc3RvcmVkUGFyYW1zKSB7CiAgICAgIGNvbnN0IHsKICAgICAgICBwYWdlLAogICAgICAgIGl0ZW1zUGVyUGFnZSwKICAgICAgICBzaXplCiAgICAgIH0gPSB0aGlzLm9wdGlvbnM7CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgLi4udGhpcy5wYXJhbSwKICAgICAgICAuLi57CiAgICAgICAgICBwYWdlOiBwYWdlLAogICAgICAgICAgc2l6ZTogaXRlbXNQZXJQYWdlID8gaXRlbXNQZXJQYWdlIDogc2l6ZSwKICAgICAgICAgIGl0ZW1zUGVyUGFnZQogICAgICAgIH0KICAgICAgfTsKICAgICAgVXNlckFwaS5nZXRVc2VySGlzdG9yeSh0aGlzLmlkLCBwYXJhbXMpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgdGhpcy5oaXN0b3J5TGlzdCA9IGRhdGEuY29udGVudDsKICAgICAgICB0aGlzLnRvdGFsSXRlbXMgPSBkYXRhLnRvdGFsRWxlbWVudHM7CiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRQYXJhbXMnLCBwYXJhbXMpOwogICAgICB9KTsKICAgIH0KICB9LAogIGFzeW5jIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMkJHN0b3JlJGdldHRlcnMkLCBfdGhpcyQkc3RvcmUkZ2V0dGVyczsKICAgIGxldCBzdG9yZWRQYXJhbXMgPSAoX3RoaXMkJHN0b3JlJGdldHRlcnMkID0gKF90aGlzJCRzdG9yZSRnZXR0ZXJzID0gdGhpcy4kc3RvcmUuZ2V0dGVycykgPT09IG51bGwgfHwgX3RoaXMkJHN0b3JlJGdldHRlcnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGlzJCRzdG9yZSRnZXR0ZXJzLnBhcmFtcykgIT09IG51bGwgJiYgX3RoaXMkJHN0b3JlJGdldHRlcnMkICE9PSB2b2lkIDAgPyBfdGhpcyQkc3RvcmUkZ2V0dGVycyQgOiB7fTsKCiAgICAvLyBmaXJzdCBsb2FkCiAgICBpZiAoIXN0b3JlZFBhcmFtcy5uYW1lIHx8IHN0b3JlZFBhcmFtcy5uYW1lICE9PSB0aGlzLiRvcHRpb25zLm5hbWUpIHsKICAgICAgdGhpcy5vcHRpb25zID0gewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgaXRlbXNQZXJQYWdlOiAxMiwKICAgICAgICBzZWFyY2hLZXl3b3JkOiBudWxsLAogICAgICAgIG5hbWU6IHRoaXMuJG9wdGlvbnMubmFtZQogICAgICB9OwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFBhcmFtcycsIE9iamVjdC5hc3NpZ24odGhpcy5wYXJhbSwgewogICAgICAgIG5hbWU6IHRoaXMuJG9wdGlvbnMubmFtZQogICAgICB9KSk7CiAgICB9IGVsc2UgewogICAgICB0aGlzLm9wdGlvbnMgPSBzdG9yZWRQYXJhbXM7CiAgICAgIHRoaXMucGFyYW0gPSBzdG9yZWRQYXJhbXM7CiAgICB9CiAgICBhd2FpdCB0aGlzLmdldEhpc3RvcnkoKTsKICB9Cn07"},{"version":3,"mappings":"AAiEA;AACA;AACA;AAEA;EACAA;EACAC;EACAC,aACA;EACAC;IACAC;IACAC,UACA;MAAAC;MAAAC;MAAAC;IAAA,GACA;MAAAF;MAAAC;MAAAC;IAAA,GACA;MAAAF;MAAAC;MAAAC;IAAA,GACA;MAAAF;MAAAC;MAAAC;IAAA,GACA;MAAAF;MAAAE;IAAA,GACA;MAAAF;MAAAE;IAAA,GACA;MAAAF;MAAAE;IAAA;IACA;IAAA,CACA;;IACAC;IACAC;MACAC;MACAC;IACA;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;IACAC;EACA;EACAC;IACAhB;MACAiB;QACA;MACA;MACAC;IACA;EACA;EACAC,WACA;EACAC;IACAC;MACA;QAAAlB;QAAAmB;QAAAC;MAAA;MACA;QAAA;QAAA;UACApB;UACAoB;UACAD;QACA;MAAA;MAEAE;QACA;QACA;QAEA;MACA;IACA;EACA;EACA;IAAA;IACA;;IAEA;IACA;MACA;QACArB;QACAmB;QACApB;QACAX;MACA;MAEA;QAAAA;MAAA;IAEA;MAEA;MACA;IAEA;IAEA;EAEA;AACA","names":["name","props","components","data","isLoading","headers","text","align","value","options","param","searchKeyword","page","totalItems","listLink","rules","states","systems","message","error","errorEmail","errorSystem","success","successEmail","historyList","watch","handler","deep","computed","methods","getHistory","itemsPerPage","size","UserApi"],"sourceRoot":"src/apps/user","sources":["UserHistory.vue"],"sourcesContent":["<template>\n  <div>\n    <v-card class=\"my-2\">\n      <v-card-title>활동 이력</v-card-title>\n      <v-card-text>\n        <v-data-table\n          :headers=\"headers\"\n          :items=\"historyList\"\n          :server-items-length=\"totalItems\"\n          :options.sync=\"options\"\n          item-key=\"id\"\n          :footer-props=\"{showFirstLastPage: true, 'items-per-page-options' : [12,20,50,100,-1], showCurrentPage:true}\"\n          class=\"flex-grow-1\"\n          disable-sort\n          show-expand\n          single-expand\n        >\n          <!--        :search=\"searchKeyword\"-->\n          <template v-slot:item.no=\"{ index }\">\n            <div>{{totalItems - ((options.page-1) * (options.itemsPerPage === -1 ? 0 : options.itemsPerPage)) - index}}</div>\n          </template>\n          <template v-slot:item.createdAt=\"{ value }\">\n            <div>{{ value | formatDate('YYYY-MM-DD HH:mm:ss') }}</div>\n          </template>\n\n<!--          <template v-slot:item.actions=\"{ item }\">-->\n<!--            <div class=\"actions\">-->\n<!--              -->\n<!--            </div>-->\n<!--          </template>-->\n\n          <template v-slot:expanded-item=\"{ headers, item }\">\n            <td :colspan=\"headers.length\">\n              {{ item.actionDescribed }}\n            </td>\n          </template>\n\n          <template #footer.page-text=\"props\">\n\n            <v-combobox\n              v-model=\"options.page\"\n              :label=\"`${props.pageStart}-${props.pageStop} of ${props.itemsLength} rows / ${options.page} page / total ${Math.ceil(props.itemsLength / options.itemsPerPage)} pages`\"\n              :items=\"Array.from({length: Math.ceil(props.itemsLength / options.itemsPerPage)}, (v, k) => k+1 )\"\n              :return-object=\"false\"\n              hide-details dense\n              type=\"number\"\n              suffix=\"page\"\n            >\n            </v-combobox>\n          </template>\n        </v-data-table>\n      </v-card-text>\n\n    </v-card>\n\n    <div class=\"d-flex align-center\">\n      <v-spacer></v-spacer>\n      <v-btn @click=\"$router.push(listLink)\" style=\"margin-left:1rem\">\n        <v-icon left>mdi mdi-format-list-bulleted</v-icon>\n        목록</v-btn>\n    </div>\n  </div>\n</template>\n\n<script>\nimport rules from \"@/utils/rules\";\nimport UserApi from \"@/api/UserApi\";\nimport config from \"@/configs\";\n\nexport default {\n  name:'userHistory',\n  props:['id'],\n  components: {\n  },\n  data: () => ({\n    isLoading: false,\n    headers: [\n      {text: '일련 번호', align: 'left', value: 'no'},\n      {text: '이력 번호', align: 'left', value: 'id'},\n      {text: '수정자 번호', align: 'left', value: 'fromId'},\n      {text: '활동 내역', align: 'left', value: 'userAction'},\n      {text: '아이피', value: 'ip'},\n      {text: '활동 일시', value: 'createdAt'},\n      { text: '', value: 'data-table-expand' }\n      // {text: '관리', sortable: false, value: 'actions'}\n    ],\n    options: {},\n    param: {\n      searchKeyword: null,\n      page: 1\n    },\n    totalItems: 0,\n    listLink:'/users',\n    rules,\n    states:config.meta.user.state,\n    systems:config.meta.systems,\n    message:{\n      error:'',\n      errorEmail:'',\n      errorSystem:null,\n      success:'',\n      successEmail:'',\n    },\n    historyList: [],\n  }),\n  watch: {\n    options: {\n      handler () {\n        this.getHistory();\n      },\n      deep: true,\n    }\n  },\n  computed: {\n  },\n  methods: {\n    getHistory(storedParams) {\n      const {  page, itemsPerPage, size } = this.options;\n      let params = {...this.param, ...{\n          page: page,\n          size: itemsPerPage ? itemsPerPage : size,\n          itemsPerPage\n        }};\n\n      UserApi.getUserHistory(this.id, params).then(data => {\n        this.historyList = data.content\n        this.totalItems = data.totalElements\n\n        this.$store.commit('setParams', params)\n      })\n    }\n  },\n  async created() {\n    let storedParams = this.$store.getters?.params??{};\n\n    // first load\n    if(!storedParams.name || storedParams.name !== this.$options.name) {\n      this.options = {\n        page:1,\n        itemsPerPage:12,\n        searchKeyword:null,\n        name:this.$options.name\n      }\n\n      this.$store.commit('setParams', Object.assign(this.param, {name:this.$options.name}))\n\n    } else {\n\n      this.options = storedParams\n      this.param = storedParams\n\n    }\n\n    await this.getHistory();\n\n  }\n}\n</script>\n<style lang=\"scss\">\n\n</style>\n"]}]}