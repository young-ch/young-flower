{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/policy/Policies.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/policy/Policies.vue","mtime":1665531625450},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/babel.config.js","mtime":1665531625438},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js","mtime":1665531751248},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBQb2xpY3lBcGkgZnJvbSAnLi4vLi4vYXBpL1BvbGljeUFwaSc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAncG9saWNpZXMnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBicmVhZGNydW1iczogW3sKICAgICAgICB0ZXh0OiAn7KCV7LGFIOygleydmCDqtIDrpqwnLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBocmVmOiAnIycKICAgICAgfSwgewogICAgICAgIHRleHQ6ICfsoJXssYUg7KCV7J2YIOuqqeuhnScKICAgICAgfV0sCiAgICAgIHNlYXJjaDogJycsCiAgICAgIGhlYWRlcnM6IFt7CiAgICAgICAgdGV4dDogJ05vLicsCiAgICAgICAgdmFsdWU6ICdpZHgnCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAn7KCV7LGFIOq3uOujuSDsvZTrk5wnLAogICAgICAgIHZhbHVlOiAncG9saWN5R3JvdXBDb2RlJwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ+ygleyxhSDsvZTrk5wnLAogICAgICAgIHZhbHVlOiAncG9saWN5Q29kZScKICAgICAgfSwgewogICAgICAgIHRleHQ6ICfsoJXssYUg7KCV7J2YIOuqhScsCiAgICAgICAgdmFsdWU6ICdwb2xpY3lOYW1lJwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ+yDneyEseyekCcsCiAgICAgICAgdmFsdWU6ICdjcmVhdGVkQnknCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAn7IOd7ISx7J28JywKICAgICAgICB2YWx1ZTogJ2NyZWF0ZWRBdCcKICAgICAgfSwgewogICAgICAgIHRleHQ6ICfsiJjsoJXsnpAnLAogICAgICAgIHZhbHVlOiAndXBkYXRlZEJ5JwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ+yImOygleydvCcsCiAgICAgICAgdmFsdWU6ICd1cGRhdGVkQXQnCiAgICAgIH0sIHsKICAgICAgICB0ZXh0OiAn6rSA66asJywKICAgICAgICB2YWx1ZTogJ2FjdGlvbicsCiAgICAgICAgc29ydGFibGU6IGZhbHNlCiAgICAgIH1dLAogICAgICBzZWxlY3RlZDogW10sCiAgICAgIHBvbGljaWVzOiBbXSwKICAgICAgb3B0aW9uczoge30sCiAgICAgIHBhcmFtOiB7fSwKICAgICAgdG90YWxJdGVtczogMCwKICAgICAgZGlhbG9nOiBmYWxzZSwKICAgICAgcnVsZXM6IHt9CiAgICB9OwogIH0sCiAgd2F0Y2g6IHsKICAgIG9wdGlvbnM6IHsKICAgICAgaGFuZGxlcigpIHsKICAgICAgICAvLyB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFBhcmFtcycsIHRoaXMub3B0aW9ucyk7CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUKICAgIH0sCiAgICAncGFyYW0uc2VhcmNoS2V5d29yZCc6IHsKICAgICAgaGFuZGxlcihudiwgb3YpIHsKICAgICAgICBpZiAobnYgPT09IG92KSByZXR1cm47CiAgICAgICAgdGhpcy5vcHRpb25zLnBhZ2UgPSAxOwogICAgICAgIHRoaXMucGFyYW0uc2VhcmNoS2V5d29yZCA9IG52OwogICAgICAgIGlmICghdGhpcy53YWl0aW5nU2VhcmNoKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgdGhpcy5nZXRQb2xpY2llcygpOwogICAgICAgICAgICB0aGlzLndhaXRpbmdTZWFyY2ggPSBmYWxzZTsKICAgICAgICAgIH0sIDUwMCk7IC8vIDAuNSBzZWMgZGVsYXkKICAgICAgICB9CgogICAgICAgIHRoaXMud2FpdGluZ1NlYXJjaCA9IHRydWU7CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGdldFBvbGljaWVzKCkgewogICAgICBjb25zdCB7CiAgICAgICAgcGFnZSwKICAgICAgICBpdGVtc1BlclBhZ2UsCiAgICAgICAgc2l6ZQogICAgICB9ID0gdGhpcy5vcHRpb25zOwogICAgICBsZXQgcGFyYW1zID0gewogICAgICAgIC4uLnRoaXMucGFyYW0sCiAgICAgICAgLi4uewogICAgICAgICAgcGFnZTogcGFnZSwKICAgICAgICAgIHNpemU6IGl0ZW1zUGVyUGFnZSA/IGl0ZW1zUGVyUGFnZSA6IHNpemUsCiAgICAgICAgICBpdGVtc1BlclBhZ2UKICAgICAgICB9CiAgICAgIH07CiAgICAgIFBvbGljeUFwaS5maW5kUG9saWNpZXMocGFyYW1zKS50aGVuKGRhdGEgPT4gewogICAgICAgIHRoaXMudG90YWxJdGVtcyA9IGRhdGEudG90YWxFbGVtZW50czsKICAgICAgICB0aGlzLnBvbGljaWVzID0gZGF0YS5jb250ZW50Lm1hcCgoYSwgaSkgPT4gewogICAgICAgICAgdmFyIF90aGlzJG9wdGlvbnMkcGFnZTsKICAgICAgICAgIGEuaWR4ID0gdGhpcy50b3RhbEl0ZW1zIC0gaSAtICgoKF90aGlzJG9wdGlvbnMkcGFnZSA9IHRoaXMub3B0aW9ucy5wYWdlKSAhPT0gbnVsbCAmJiBfdGhpcyRvcHRpb25zJHBhZ2UgIT09IHZvaWQgMCA/IF90aGlzJG9wdGlvbnMkcGFnZSA6IDEpIC0gMSkgKiBwYXJhbXMuc2l6ZTsKICAgICAgICAgIHJldHVybiBhOwogICAgICAgIH0pOwogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0UGFyYW1zJywgcGFyYW1zKTsKICAgICAgfSk7CiAgICB9LAogICAgdXBkYXRlUG9saWN5KHBvbGljeSkgewogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7CiAgICAgICAgcGF0aDogYC9wb2xpY2llcy8ke3BvbGljeS5pZH1gCiAgICAgIH0pOwogICAgfSwKICAgIGRlbGV0ZVBvbGljeShwb2xpY3kpIHsKICAgICAgaWYgKGNvbmZpcm0oJ+yCreygnO2VmOyLnOqyoOyKteuLiOq5jD8nKSkgUG9saWN5QXBpLmRlbGV0ZShwb2xpY3kuaWQpLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMucG9saWNpZXMgPSB0aGlzLnBvbGljaWVzLmZpbHRlcihyID0+IHIgIT09IHBvbGljeSk7CiAgICAgICAgYWxlcnQoIuyCreygnOuQmOyXiOyKteuLiOuLpC4iKTsKICAgICAgfSk7CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzJCRzdG9yZSRnZXR0ZXJzJCwgX3RoaXMkJHN0b3JlJGdldHRlcnM7CiAgICBsZXQgc3RvcmVkUGFyYW1zID0gKF90aGlzJCRzdG9yZSRnZXR0ZXJzJCA9IChfdGhpcyQkc3RvcmUkZ2V0dGVycyA9IHRoaXMuJHN0b3JlLmdldHRlcnMpID09PSBudWxsIHx8IF90aGlzJCRzdG9yZSRnZXR0ZXJzID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfdGhpcyQkc3RvcmUkZ2V0dGVycy5wYXJhbXMpICE9PSBudWxsICYmIF90aGlzJCRzdG9yZSRnZXR0ZXJzJCAhPT0gdm9pZCAwID8gX3RoaXMkJHN0b3JlJGdldHRlcnMkIDoge307CgogICAgLy8gZmlyc3QgbG9hZAogICAgaWYgKCFzdG9yZWRQYXJhbXMubmFtZSB8fCBzdG9yZWRQYXJhbXMubmFtZSAhPT0gdGhpcy4kb3B0aW9ucy5uYW1lKSB7CiAgICAgIHRoaXMub3B0aW9ucyA9IHsKICAgICAgICBwYWdlOiAxLAogICAgICAgIGl0ZW1zUGVyUGFnZTogMTIsCiAgICAgICAgc2VhcmNoS2V5d29yZDogbnVsbCwKICAgICAgICBuYW1lOiB0aGlzLiRvcHRpb25zLm5hbWUKICAgICAgfTsKICAgICAgc3RvcmVkUGFyYW1zID0gdGhpcy5vcHRpb25zOwogICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFBhcmFtcycsIHN0b3JlZFBhcmFtcyk7CiAgICB9IGVsc2UgewogICAgICBzdG9yZWRQYXJhbXMubmFtZSA9IHRoaXMuJG9wdGlvbnMubmFtZTsKICAgICAgdGhpcy5vcHRpb25zID0gc3RvcmVkUGFyYW1zOwogICAgfQogICAgLy8gYXdhaXQgdGhpcy5nZXRJbnNwZWN0aW9ucyhzdG9yZWRQYXJhbXMpCiAgICB0aGlzLnNlYXJjaEtleXdvcmQgPSB0aGlzLm9wdGlvbnMuc2VhcmNoS2V5d29yZCA/IHRoaXMub3B0aW9ucy5zZWFyY2hLZXl3b3JkIDogbnVsbDsKICAgIHRoaXMuZ2V0UG9saWNpZXMoKTsKICB9Cn07"},{"version":3,"mappings":";AAmGA;AAEA;EACAA;EACAC;IACA;MACAC;QACAC;QACAC;QACAC;MACA;QACAF;MACA;MAEAG;MACAC,UACA;QAAAJ;QAAAK;MAAA,GACA;QAAAL;QAAAK;MAAA,GACA;QAAAL;QAAAK;MAAA,GACA;QAAAL;QAAAK;MAAA,GACA;QAAAL;QAAAK;MAAA,GACA;QAAAL;QAAAK;MAAA,GACA;QAAAL;QAAAK;MAAA,GACA;QAAAL;QAAAK;MAAA,GACA;QAAAL;QAAAK;QAAAC;MAAA,EACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC,QACA;IACA;EACA;EACAC;IACAL;MACAM;QACA;MACA;MACAC;IACA;IACA;MACAD;QACA,eACA;QAEA;QACA;QACA;UACAE;YACA;YACA;UACA;QACA;;QACA;MACA;MACAD;IACA;EACA;EACAE;IACAC;MACA;QAAAC;QAAAC;QAAAC;MAAA;MACA;QAAA;QAAA;UACAF;UACAE;UACAD;QACA;MAAA;MAEAE;QACA;QACA;UAAA;UACAC;UACA;QACA;QACA;MAEA;IACA;IACAC;MACA;QAAAC;MAAA;IACA;IACAC;MACA,0BAEAJ;QACA;QACAK;MACA;IACA;EAEA;EACAC;IAAA;IACA;;IAEA;IACA;MACA;QACAT;QACAC;QACAS;QACAjC;MACA;MAEAkC;MACA;IAEA;MACAA;MACA;IACA;IACA;IACA;IAEA;EACA;AAEA","names":["name","data","breadcrumbs","text","disabled","href","search","headers","value","sortable","selected","policies","options","param","totalItems","dialog","rules","watch","handler","deep","setTimeout","methods","getPolicies","page","itemsPerPage","size","PolicyApi","a","updatePolicy","path","deletePolicy","alert","created","searchKeyword","storedParams"],"sourceRoot":"src/apps/policy","sources":["Policies.vue"],"sourcesContent":["<template>\n  <div class=\"d-flex flex-column flex-grow-1\">\n\n    <div class=\"d-flex align-center py-3\">\n      <div>\n        <div class=\"display-1\">정책 정의 관리</div>\n        <v-breadcrumbs :items=\"breadcrumbs\" class=\"pa-0 py-2\"></v-breadcrumbs>\n      </div>\n      <v-spacer></v-spacer>\n      <v-btn color=\"primary\" to=\"/policy/form\" style=\"margin-right:1rem\">\n        <v-icon left>mdi mdi-playlist-plus</v-icon>\n        정책 정의 추가\n      </v-btn>\n    </div>\n\n    <v-card>\n      <v-card-title>\n\n        <v-spacer></v-spacer>\n        <v-text-field\n          v-model=\"param.searchKeyword\"\n          append-icon=\"mdi-magnify\"\n          class=\"flex-grow-1 mr-md-2\"\n          label=\"그룹코드, 코드, 명칭, 설명 검색\"\n          dense\n          single-line\n          hide-details\n          clearable\n          @click:append=\"getPolicies\"\n          @keyup.enter=\"getPolicies\"\n        ></v-text-field>\n      </v-card-title>\n\n      <v-data-table\n        :headers=\"headers\"\n        :items=\"policies\"\n        :server-items-length=\"totalItems\"\n        :options.sync=\"options\"\n        item-key=\"id\"\n        class=\"elevation-1\"\n        :sortable=\"true\"\n        :footer-props=\"{showFirstLastPage: true, 'items-per-page-options' : [10,20,50,100,-1], showCurrentPage:true}\"\n      >\n        <template v-slot:item.policyName=\"{ item }\">\n          <router-link :to=\"{path:`/policies/${item.id}`}\">{{ item.policyName }}</router-link>\n        </template>\n\n        <template v-slot:item.createdAt=\"{ value }\">\n          <div>{{ value | formatDate('YYYY-MM-DD HH:mm:ss') }}</div>\n        </template>\n\n        <template v-slot:item.updatedAt=\"{ value }\">\n          <div>{{ value | formatDate('YYYY-MM-DD HH:mm:ss') }}</div>\n        </template>\n\n        <template v-slot:item.action=\"{ item }\">\n<!--          <v-icon-->\n<!--            class=\"mr-2\"-->\n<!--            @click.stop=\"updatePolicy(item)\"-->\n<!--            small-->\n<!--          >-->\n<!--            mdi-pencil-->\n<!--          </v-icon>-->\n          <v-icon\n            class=\"mr-2\"\n            @click.stop=\"deletePolicy(item)\"\n            small\n          >\n            mdi-delete\n          </v-icon>\n        </template>\n        <template #footer.page-text=\"props\">\n\n          <v-combobox\n            v-model=\"options.page\"\n            :label=\"`${props.pageStart}-${props.pageStop} of ${props.itemsLength} rows / ${options.page} page / total ${Math.ceil((props.itemsLength > 0 ? props.itemsLength : 1 ) / options.itemsPerPage)} pages`\"\n            :items=\"Array.from({length: Math.ceil(props.itemsLength / options.itemsPerPage)}, (v, k) => k+1 )\"\n            :return-object=\"false\"\n            hide-details dense\n            type=\"number\"\n            suffix=\"page\"\n          >\n          </v-combobox>\n        </template>\n      </v-data-table>\n    </v-card>\n\n\n    <div class=\"d-flex align-center py-3\">\n      <v-spacer></v-spacer>\n      <v-btn color=\"primary\" to=\"/policy/form\" style=\"margin-right:1rem\">\n        <v-icon left>mdi mdi-playlist-plus</v-icon>\n        정책 정의 추가\n      </v-btn>\n    </div>\n  </div>\n</template>\n\n<script>\nimport PolicyApi from '../../api/PolicyApi';\n\nexport default {\n  name: 'policies',\n  data() {\n    return {\n      breadcrumbs: [{\n        text: '정책 정의 관리',\n        disabled: false,\n        href: '#'\n      }, {\n        text: '정책 정의 목록'\n      }],\n\n      search: '',\n      headers: [\n        {text: 'No.', value: 'idx'},\n        {text: '정책 그룹 코드', value: 'policyGroupCode'},\n        {text: '정책 코드', value: 'policyCode'},\n        {text: '정책 정의 명', value: 'policyName'},\n        {text: '생성자', value: 'createdBy'},\n        {text: '생성일', value: 'createdAt'},\n        {text: '수정자', value: 'updatedBy'},\n        {text: '수정일', value: 'updatedAt'},\n        {text: '관리', value: 'action', sortable: false }\n      ],\n      selected: [],\n      policies: [],\n      options: {},\n      param: {},\n      totalItems: 0,\n      dialog: false,\n      rules: {\n      }\n    }\n  },\n  watch: {\n    options: {\n      handler() {\n        // this.$store.commit('setParams', this.options);\n      },\n      deep: true,\n    },\n    'param.searchKeyword': {\n      handler(nv, ov) {\n        if(nv === ov)\n          return;\n\n        this.options.page = 1;\n        this.param.searchKeyword = nv;\n        if (!this.waitingSearch) {\n          setTimeout(() => {\n            this.getPolicies();\n            this.waitingSearch = false;\n          }, 500); // 0.5 sec delay\n        }\n        this.waitingSearch = true;\n      },\n      deep: true\n    }\n  },\n  methods: {\n    getPolicies() {\n      const {  page, itemsPerPage, size } = this.options;\n      let params = {...this.param, ...{\n          page: page,\n          size: itemsPerPage ? itemsPerPage : size,\n          itemsPerPage\n        }};\n\n      PolicyApi.findPolicies(params).then(data => {\n        this.totalItems = data.totalElements;\n        this.policies = data.content.map((a, i) => {\n          a.idx = this.totalItems - i - (((this.options.page ?? 1) - 1) * params.size)\n          return a\n        });\n        this.$store.commit('setParams', params);\n\n      })\n    },\n    updatePolicy(policy) {\n      this.$router.push({path : `/policies/${policy.id}`})\n    },\n    deletePolicy(policy) {\n      if (confirm('삭제하시겠습니까?'))\n\n        PolicyApi.delete(policy.id).then(() => {\n          this.policies = this.policies.filter(r => r !== policy)\n          alert(\"삭제되었습니다.\")\n        })\n    }\n\n  },\n  created() {\n    let storedParams = this.$store.getters?.params??{};\n\n    // first load\n    if(!storedParams.name || storedParams.name !== this.$options.name) {\n      this.options = {\n        page:1,\n        itemsPerPage:12,\n        searchKeyword:null,\n        name:this.$options.name\n      }\n\n      storedParams = this.options\n      this.$store.commit('setParams', storedParams)\n\n    } else {\n      storedParams.name = this.$options.name\n      this.options = storedParams\n    }\n    // await this.getInspections(storedParams)\n    this.searchKeyword = this.options.searchKeyword ? this.options.searchKeyword : null\n\n    this.getPolicies();\n  }\n\n};\n</script>\n"]}]}