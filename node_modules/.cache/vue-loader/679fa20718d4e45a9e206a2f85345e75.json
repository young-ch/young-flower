{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/endpoint/Endpoints.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/endpoint/Endpoints.vue","mtime":1665531625450},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js","mtime":1665531751248},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBFbmRwb2ludEFwaSBmcm9tICcuLi8uLi9hcGkvRW5kcG9pbnRBcGknOwppbXBvcnQgcnVsZXMgZnJvbSAiQC91dGlscy9ydWxlcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGJyZWFkY3J1bWJzOiBbewogICAgICAgIHRleHQ6ICdBUEkg6rO16rCcIOq0gOumrCcsCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGhyZWY6ICcjJwogICAgICB9LCB7CiAgICAgICAgdGV4dDogJ0FQSSDrqqnroZ0nCiAgICAgIH1dLAoKICAgICAgc2VhcmNoOiAnJywKICAgICAgaGVhZGVyczogWwogICAgICAgIHt0ZXh0OiAn6rO16rCcJywgdmFsdWU6ICdpc1B1YmxpYycsIGFsaWduOiAnY2VudGVyJ30sCiAgICAgICAge3RleHQ6ICd1cmknLCB2YWx1ZTogJ3VyaScsIGFsaWduOiAnbGVmdCd9LAogICAgICAgIHt0ZXh0OiAnaHR0cCBtZXRob2QnLCB2YWx1ZTogJ2h0dHBNZXRob2QnLCBhbGlnbjogJ2xlZnQnfSwKICAgICAgICB7dGV4dDogJ2FwaSB0aXRsZScsIHZhbHVlOiAnb3BlcmF0aW9uRGVzY3JpcHRpb24nLCBhbGlnbjogJ2xlZnQnfSwKICAgICAgICB7dGV4dDogJ3Jlc291cmNlIHRpdGxlJywgdmFsdWU6ICdyZXNvdXJjZURlc2NyaXB0aW9uJywgYWxpZ246ICdsZWZ0J30KICAgICAgXSwKICAgICAgc2VsZWN0ZWQ6IFtdLAogICAgICBlbmRwb2ludHM6IFtdLAogICAgICBwYXJhbTogewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgc2l6ZTogMTAKICAgICAgfSwKICAgICAgb3B0aW9uczp7fSwKICAgICAgY3VycmVudFBhZ2U6eyd2YWx1ZSc6MSwgJ3RleHQnOidwYWdlIDEnfSwKICAgICAgdG90YWxDb3VudDogbnVsbCwKICAgICAgZGlhbG9nOiBmYWxzZSwKICAgICAgcnVsZXMKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHB1YmxpY0NoYW5nZShpdGVtKSB7CiAgICAgIC8vIGlmIChjb25maXJtKChpdGVtLmlzUHVibGljID8gJ+qzteqwnOuhnCcgOiAn67mE6rO16rCc66GcJykgKyAiIOyghO2ZmCDtlZjsi5zqsqDsirXri4jquYw/IikpIHsKICAgICAgICBhd2FpdCBFbmRwb2ludEFwaS5jaGFuZ2VQdWJsaWNFbmRwb2ludChpdGVtKQogICAgICAvLyB9IGVsc2UgewogICAgICAvLyAgIGl0ZW0uaXNQdWJsaWMgPSAhaXRlbS5pc1B1YmxpYwogICAgICAvLyB9CiAgICB9LAogICAgYXN5bmMgZ2V0RW5kcG9pbnRzKCkgewoKICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoW0VuZHBvaW50QXBpLmdldFB1YmxpY0VuZHBvaW50cygpLCBFbmRwb2ludEFwaS5nZXRFbmRwb2ludHMoKV0pCiAgICAgICAgLnRoZW4oKFtwcywgZW5kcG9pbnRzXSkgPT4gewogICAgICAgICAgY29uc3QgcHVibGljRW5kcG9pbnRzID0gcHMubWFwKHAgPT4gcC5lbmRwb2ludCk7CiAgICAgICAgICB0aGlzLmVuZHBvaW50cyA9IGVuZHBvaW50cy5tYXAoZWxlID0+IHsKICAgICAgICAgICAgZWxlLmlzUHVibGljID0gISFwdWJsaWNFbmRwb2ludHMuZmluZChwZSA9PiBwZS51cmkgPT09IGVsZS51cmkgJiYgcGUuaHR0cE1ldGhvZCA9PT0gZWxlLmh0dHBNZXRob2QpOwogICAgICAgICAgICBlbGUuaXRlbUtleSA9IGVsZS51cmkgKyAnXycgKyBlbGUuaHR0cE1ldGhvZAogICAgICAgICAgICByZXR1cm4gZWxlOwogICAgICAgICAgfSk7CiAgICAgICAgICAvLyB0aGlzLnRvdGFsQ291bnQgPSBlbmRwb2ludHMubGVuZ3RoOwogICAgICB9KQoKICAgIH0sCiAgICBzZWN1cmVNYXBwaW5nKCkgewogICAgICBpZiAodGhpcy5zZWxlY3RlZCAmJiB0aGlzLnNlbGVjdGVkLmxlbmd0aCA+IDApIHsKCiAgICAgICAgaWYgKGNvbmZpcm0oIuu5hOqzteqwnCDsoITtmZgg7ZWY7Iuc6rKg7Iq164uI6rmMPyIpKSB7CiAgICAgICAgICBFbmRwb2ludEFwaS5kZWxldGVQdWJsaWNFbmRwb2ludHModGhpcy5zZWxlY3RlZCkudGhlbigoKSA9PiB7CgogICAgICAgICAgICB0aGlzLmVuZHBvaW50cy5mb3JFYWNoKGUgPT4gewogICAgICAgICAgICAgIGlmKHRoaXMuc2VsZWN0ZWQuaW5jbHVkZXMoZSkpCiAgICAgICAgICAgICAgICBlLmlzUHVibGljID0gZmFsc2UKICAgICAgICAgICAgfSkKCiAgICAgICAgICB9KQogICAgICAgIH0KCiAgICAgIH0gZWxzZQogICAgICAgIGFsZXJ0KCJBUEkg66W8IOyEoO2Dne2VtOyjvOyEuOyalC4iKQogICAgfSwKICAgIHB1YmxpY01hcHBpbmcoKSB7CiAgICAgIGlmICh0aGlzLnNlbGVjdGVkICYmIHRoaXMuc2VsZWN0ZWQubGVuZ3RoID4gMCkgewogICAgICAgIGlmIChjb25maXJtKCLqs7XqsJwg7KCE7ZmYIO2VmOyLnOqyoOyKteuLiOq5jD8iKSkgewogICAgICAgICAgRW5kcG9pbnRBcGkuc2F2ZVB1YmxpY0VuZHBvaW50KHRoaXMuc2VsZWN0ZWQpLnRoZW4oKCkgPT4gewogICAgICAgICAgICB0aGlzLmVuZHBvaW50cy5mb3JFYWNoKGUgPT4gewogICAgICAgICAgICAgIGlmKHRoaXMuc2VsZWN0ZWQuaW5jbHVkZXMoZSkpCiAgICAgICAgICAgICAgICBlLmlzUHVibGljID0gdHJ1ZQogICAgICAgICAgICB9KQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0gZWxzZQogICAgICAgIGFsZXJ0KCJBUEkg66W8IOyEoO2Dne2VtOyjvOyEuOyalC4iKQogICAgfSwKCiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRQYXJhbXMnLCB7fSkKICAgIHRoaXMuZ2V0RW5kcG9pbnRzKCk7CiAgfQoKfTsK"},{"version":3,"sources":["Endpoints.vue"],"names":[],"mappings":";AAqGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"Endpoints.vue","sourceRoot":"src/apps/endpoint","sourcesContent":["<template>\n  <div class=\"d-flex flex-column flex-grow-1\">\n\n    <div class=\"d-flex align-center py-3\">\n      <div>\n        <div class=\"display-1\">API 공개 관리</div>\n        <v-breadcrumbs :items=\"breadcrumbs\" class=\"pa-0 py-2\"></v-breadcrumbs>\n      </div>\n      <v-spacer></v-spacer>\n      <v-btn color=\"red\" @click=\"secureMapping\" dark>\n        <v-icon small left>mdi-lock</v-icon>\n        비공개 API\n      </v-btn>\n      <v-btn color=\"indigo\" @click=\"publicMapping\" style=\"margin-left:1rem\" dark>\n        <v-icon small left>mdi-lock-open-variant</v-icon>\n        공개 API\n      </v-btn>\n    </div>\n\n    <v-card>\n      <v-card-title>\n        <v-spacer></v-spacer>\n        <v-text-field\n          v-model=\"search\"\n          append-icon=\"mdi-magnify\"\n          class=\"flex-grow-1 mr-md-2\"\n          label=\"검색\"\n          dense\n          single-line\n          hide-details\n          clearable\n        ></v-text-field>\n      </v-card-title>\n\n      <v-data-table\n        v-model=\"selected\"\n        :search=\"search\"\n        :headers=\"headers\"\n        :items=\"endpoints\"\n        show-select\n        item-key=\"itemKey\"\n        class=\"elevation-1\"\n        sortable=\"false\"\n        :footer-props=\"{showFirstLastPage: true, 'items-per-page-options' : [10,20,50,100,-1], showCurrentPage:true}\"\n        @click:row=\"(item, row) => row.select(!row.isSelected)\"\n        :options.sync=\"options\"\n      >\n        <template v-slot:item.isPublic=\"{ item }\">\n          <v-switch\n            v-model=\"item.isPublic\"\n            flat\n            @click.native.stop=\"publicChange(item)\"\n            :color=\"item.isPublic ? 'success' : 'error'\"\n          >\n<!--            :label=\"item.isPublic ?'공개':'비공개'\"-->\n          </v-switch>\n        </template>\n        <template #footer.page-text=\"props\">\n\n            <v-combobox\n              v-model=\"options.page\"\n              :label=\"`${props.pageStart}-${props.pageStop} of ${props.itemsLength} rows / ${options.page} page / total ${Math.ceil(props.itemsLength / options.itemsPerPage)} pages`\"\n              :items=\"Array.from({length: Math.ceil(props.itemsLength / options.itemsPerPage)}, (v, k) => k+1 )\"\n              :return-object=\"false\"\n              hide-details dense\n              type=\"number\"\n              suffix=\"page\"\n            >\n<!--              :value=\"{'value':options.page, 'text': `page ${options.page}`}\"-->\n<!--              @change=\"(v) => options.page = v ? v : 1\"-->\n<!--              :items=\"Array.from({length: Math.ceil(props.itemsLength / options.itemsPerPage)}, (v, k) => { return {'value':k+1, 'text': `page ${k+1}`} })\"-->\n\n            </v-combobox>\n\n<!--          total {{Math.ceil(props.itemsLength / options.itemsPerPage)}} pages-->\n\n<!--          <v-pagination-->\n<!--            v-model=\"page\"-->\n<!--            :length=\"props.itemsLength\">-->\n<!--          </v-pagination>-->\n        </template>\n      </v-data-table>\n\n    </v-card>\n\n    <div class=\"d-flex align-center py-3\">\n      <v-spacer></v-spacer>\n      <v-btn color=\"red\" @click=\"secureMapping\" dark>\n        <v-icon small left>mdi-lock</v-icon>\n        비공개 API\n      </v-btn>\n      <v-btn color=\"indigo\" @click=\"publicMapping\" style=\"margin-left:1rem\" dark>\n        <v-icon small left>mdi-lock-open-variant</v-icon>\n        공개 API\n      </v-btn>\n    </div>\n\n  </div>\n</template>\n\n<script>\nimport EndpointApi from '../../api/EndpointApi';\nimport rules from \"@/utils/rules\";\n\nexport default {\n  data() {\n    return {\n      breadcrumbs: [{\n        text: 'API 공개 관리',\n        disabled: false,\n        href: '#'\n      }, {\n        text: 'API 목록'\n      }],\n\n      search: '',\n      headers: [\n        {text: '공개', value: 'isPublic', align: 'center'},\n        {text: 'uri', value: 'uri', align: 'left'},\n        {text: 'http method', value: 'httpMethod', align: 'left'},\n        {text: 'api title', value: 'operationDescription', align: 'left'},\n        {text: 'resource title', value: 'resourceDescription', align: 'left'}\n      ],\n      selected: [],\n      endpoints: [],\n      param: {\n        page: 1,\n        size: 10\n      },\n      options:{},\n      currentPage:{'value':1, 'text':'page 1'},\n      totalCount: null,\n      dialog: false,\n      rules\n    }\n  },\n  methods: {\n    async publicChange(item) {\n      // if (confirm((item.isPublic ? '공개로' : '비공개로') + \" 전환 하시겠습니까?\")) {\n        await EndpointApi.changePublicEndpoint(item)\n      // } else {\n      //   item.isPublic = !item.isPublic\n      // }\n    },\n    async getEndpoints() {\n\n      await Promise.all([EndpointApi.getPublicEndpoints(), EndpointApi.getEndpoints()])\n        .then(([ps, endpoints]) => {\n          const publicEndpoints = ps.map(p => p.endpoint);\n          this.endpoints = endpoints.map(ele => {\n            ele.isPublic = !!publicEndpoints.find(pe => pe.uri === ele.uri && pe.httpMethod === ele.httpMethod);\n            ele.itemKey = ele.uri + '_' + ele.httpMethod\n            return ele;\n          });\n          // this.totalCount = endpoints.length;\n      })\n\n    },\n    secureMapping() {\n      if (this.selected && this.selected.length > 0) {\n\n        if (confirm(\"비공개 전환 하시겠습니까?\")) {\n          EndpointApi.deletePublicEndpoints(this.selected).then(() => {\n\n            this.endpoints.forEach(e => {\n              if(this.selected.includes(e))\n                e.isPublic = false\n            })\n\n          })\n        }\n\n      } else\n        alert(\"API 를 선택해주세요.\")\n    },\n    publicMapping() {\n      if (this.selected && this.selected.length > 0) {\n        if (confirm(\"공개 전환 하시겠습니까?\")) {\n          EndpointApi.savePublicEndpoint(this.selected).then(() => {\n            this.endpoints.forEach(e => {\n              if(this.selected.includes(e))\n                e.isPublic = true\n            })\n          })\n        }\n      } else\n        alert(\"API 를 선택해주세요.\")\n    },\n\n  },\n  created() {\n    this.$store.commit('setParams', {})\n    this.getEndpoints();\n  }\n\n};\n</script>\n"]}]}