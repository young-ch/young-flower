{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/role/RoleForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/role/RoleForm.vue","mtime":1665531625451},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js","mtime":1665531751248},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgppbXBvcnQgUm9sZUFwaSBmcm9tICcuLi8uLi9hcGkvUm9sZUFwaScKaW1wb3J0IE1lbnVBcGkgZnJvbSAiQC9hcGkvTWVudUFwaSI7CgppbXBvcnQgcnVsZXMgZnJvbSAiQC91dGlscy9ydWxlcyI7CgppbXBvcnQgRW5kcG9pbnRzIGZyb20gIkAvY29tcG9uZW50cy9hcHAvRW5kcG9pbnRzIgppbXBvcnQgTWVudXMgZnJvbSAiQC9jb21wb25lbnRzL2FwcC9NZW51cyIKaW1wb3J0IFBvbGljaWVzIGZyb20gIkAvY29tcG9uZW50cy9hcHAvUG9saWNpZXMiCgppbXBvcnQgXyBmcm9tICJsb2Rhc2giOwppbXBvcnQgUG9saWN5QXBpIGZyb20gIkAvYXBpL1BvbGljeUFwaSI7CgpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgRW5kcG9pbnRzLAogICAgTWVudXMsCiAgICBQb2xpY2llcwogIH0sCiAgcHJvcHM6IFsnaWQnXSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGFiOiBudWxsLAogICAgICBydWxlcywKICAgICAgYnJlYWRjcnVtYnM6IFt7CiAgICAgICAgdGV4dDogJ+yXre2VoOq0gOumrCcsCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGhyZWY6ICcjJwogICAgICB9LCB7CiAgICAgICAgdGV4dDogdGhpcy4kcHJvcHMuaWQgPyAn7Jet7ZWg7IiY7KCVJyA6ICfsl63tlaDrk7HroZ0nCiAgICAgIH1dLAogICAgICByb2xlOiB7CiAgICAgIH0sCiAgICAgIGNvcGllZFJvbGU6IHt9LAogICAgICBzZWxlY3RlZEVuZHBvaW50OiBbXSwKICAgICAgc2VsZWN0ZWRQb2xpY3k6IFtdLAogICAgICBjb3BpZWRTZWxlY3RlZEVuZHBvaW50OiBbXSwKICAgICAgY29waWVkU2VsZWN0ZWRQb2xpY3k6IFtdLAogICAgICBzZWxlY3RlZFVzZXJNZW51OiBbXSwKICAgICAgc2VsZWN0ZWRBZG1pbk1lbnU6IFtdLAogICAgICBjb3BpZWRVc2VyU2VsZWN0ZWRNZW51OiBbXSwKICAgICAgY29waWVkQWRtaW5TZWxlY3RlZE1lbnU6IFtdLAogICAgICBlbmRwb2ludEhlYWRlcjogWwogICAgICAgIHt0ZXh0OiAncmVzb3VyY2UgdGl0bGUnLCB2YWx1ZTogJ3Jlc291cmNlRGVzY3JpcHRpb24nLCBhbGlnbjogJ2xlZnQnfSwKICAgICAgICB7dGV4dDogJ2FwaSB0aXRsZScsIHZhbHVlOiAnb3BlcmF0aW9uRGVzY3JpcHRpb24nLCBhbGlnbjogJ2xlZnQnfSwKICAgICAgICB7dGV4dDogJ3VyaScsIHZhbHVlOiAndXJpJywgYWxpZ246ICdsZWZ0J30sCiAgICAgICAge3RleHQ6ICdodHRwIG1ldGhvZCcsIHZhbHVlOiAnaHR0cE1ldGhvZCcsIGFsaWduOiAnbGVmdCd9LAogICAgICAgIHt0ZXh0OiAn6rO16rCcIOyXrOu2gCcsIHZhbHVlOiAnaXNQdWJsaWNUZXh0J30KICAgICAgXSwKICAgICAgcG9saWN5SGVhZGVyOiBbCiAgICAgICAge3RleHQ6ICfsoJXssYUg6re466O5IOy9lOuTnCcsIHZhbHVlOiAncG9saWN5R3JvdXBDb2RlJywgYWxpZ246ICdsZWZ0J30sCiAgICAgICAge3RleHQ6ICfsoJXssYUg7L2U65OcJywgdmFsdWU6ICdwb2xpY3lDb2RlJywgYWxpZ246ICdsZWZ0J30sCiAgICAgICAge3RleHQ6ICfsoJXssYUg66qFJywgdmFsdWU6ICdwb2xpY3lOYW1lJywgYWxpZ246ICdsZWZ0J30KICAgICAgXQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgc2F2ZVJvbGUoKSB7CiAgICAgIGlmKHRoaXMucm9sZS5pZCA9PT0gMSkgewogICAgICAgIGFsZXJ0KCLqtIDrpqzsnpAg7Jet7ZWg7J2AIOyImOygle2VmOqxsOuCmCDsgq3soJztlZjsi6Qg7IiYIOyXhuyKteuLiOuLpC4iKQogICAgICAgIHJldHVybiBmYWxzZQogICAgICB9CiAgICAgIGNvbnN0IGlzVmFsaWRSb2xlRm9ybSA9IGF3YWl0IHRoaXMuJHJlZnMucm9sZUZvcm0udmFsaWRhdGUoKQogICAgICBpZiAoY29uZmlybSgi7Jet7ZWgIOygleuztOulvCDsoIDsnqXtlZjsi5zqsqDsirXri4jquYw/IikgJiYgaXNWYWxpZFJvbGVGb3JtKSB7CgogICAgICAgIGNvbnN0IHNlbGVjdGVkRW5kcG9pbnQgPSB0aGlzLiRyZWZzWyJ0YWJzLWVuZHBvaW50Il0uc2VsZWN0ZWQ7CiAgICAgICAgdGhpcy5yb2xlLnJvbGVFbmRwb2ludHMgPSBzZWxlY3RlZEVuZHBvaW50Lm1hcChlID0+IHsgcmV0dXJuIHsnaWQnOiB7J3VyaSc6IGUudXJpLCAnaHR0cE1ldGhvZCc6ZS5odHRwTWV0aG9kfX19KQoKICAgICAgICBjb25zdCBzZWxlY3RlZFBvbGljeSA9IHRoaXMuJHJlZnNbInRhYnMtcG9saWN5Il0/LnNlbGVjdGVkPz90aGlzLmNvcGllZFNlbGVjdGVkUG9saWN5Lm1hcChwID0+IHsgcmV0dXJuIHsnaWQnOiBwLmlkfSB9KQogICAgICAgIHRoaXMucm9sZS5yb2xlUG9saWNpZXMgPSBzZWxlY3RlZFBvbGljeS5tYXAoZSA9PiB7IHJldHVybiB7J2lkJzogeydwb2xpY3lJZCc6IGUuaWR9fX0pCgogICAgICAgIGNvbnN0IHNlbGVjdGVkQWRtaW5NZW51ID0gdGhpcy4kcmVmc1sidGFicy1hZG1pbi1tZW51Il0/LnNlbGVjdGVkPz90aGlzLmNvcGllZEFkbWluU2VsZWN0ZWRNZW51Lm1hcChlID0+IHsgcmV0dXJuIHsnaWQnOmUubWVudUlkfX0pCiAgICAgICAgY29uc3Qgc2VsZWN0ZWRVc2VyTWVudSA9IHRoaXMuJHJlZnNbInRhYnMtdXNlci1tZW51Il0/LnNlbGVjdGVkPz90aGlzLmNvcGllZFVzZXJTZWxlY3RlZE1lbnUubWFwKGUgPT4geyByZXR1cm4geydpZCc6ZS5tZW51SWR9fSkKICAgICAgICB0aGlzLnJvbGUucm9sZU1lbnVzID0gWy4uLnNlbGVjdGVkQWRtaW5NZW51Lm1hcChlID0+IHsgcmV0dXJuIHsnaWQnOiB7J21lbnVJZCc6ZS5pZH19fSksIC4uLnNlbGVjdGVkVXNlck1lbnUubWFwKGUgPT4geyByZXR1cm4geydpZCc6IHsnbWVudUlkJzplLmlkfX19KV0KCiAgICAgICAgUm9sZUFwaS5zYXZlUm9sZSh0aGlzLnJvbGUpLnRoZW4ocmVzdWx0ID0+IHsKICAgICAgICAgIHRoaXMucm9sZS5pZCA9IHJlc3VsdC5pZAogICAgICAgICAgYWxlcnQoIuyggOyepeuQmOyXiOyKteuLiOuLpC4iKQogICAgICAgICAgLy8gdGhpcy4kcm91dGVyLnB1c2goe3BhdGg6ICcvcm9sZXMnfSkKICAgICAgICB9KQogICAgICB9CiAgICB9LAogICAgZ29Ub0xpc3QoKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtwYXRoOiAnL3JvbGVzJ30pCiAgICB9LAogICAgcmVzZXRSb2xlKCkgewogICAgICB0aGlzLnJvbGUgPSBfLmNsb25lRGVlcCh0aGlzLmNvcGllZFJvbGUpCiAgICAgIHRoaXMuc2VsZWN0ZWRFbmRwb2ludCA9IF8uY2xvbmVEZWVwKHRoaXMuY29waWVkU2VsZWN0ZWRFbmRwb2ludCkKICAgICAgdGhpcy5zZWxlY3RlZFBvbGljeSA9IF8uY2xvbmVEZWVwKHRoaXMuY29waWVkU2VsZWN0ZWRQb2xpY3kpCiAgICAgIHRoaXMuc2VsZWN0ZWRVc2VyTWVudSA9IF8uY2xvbmVEZWVwKHRoaXMuY29waWVkVXNlclNlbGVjdGVkTWVudSkKICAgICAgdGhpcy5zZWxlY3RlZEFkbWluTWVudSA9IF8uY2xvbmVEZWVwKHRoaXMuY29waWVkQWRtaW5TZWxlY3RlZE1lbnUpCiAgICB9LAogICAgZGVsZXRlUm9sZShyb2xlKSB7CiAgICAgIGlmKHJvbGUuaWQgPT09IDEpIHsKICAgICAgICBhbGVydCgi6rSA66as7J6QIOyXre2VoOydgCDsiJjsoJXtlZjqsbDrgpgg7IKt7KCc7ZWY7IukIOyImCDsl4bsirXri4jri6QuIikKICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgfQogICAgICBpZiAoY29uZmlybSgn7IKt7KCc7ZWY7Iuc6rKg7Iq164uI6rmMPycpKQogICAgICAgIFJvbGVBcGkuZGVsZXRlUm9sZShyb2xlLmlkKS50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMucm9sZXMgPSB0aGlzLnJvbGVzLmZpbHRlcihyID0+IHIgIT09IHJvbGUpCiAgICAgICAgICBhbGVydCgi7IKt7KCc65CY7JeI7Iq164uI64ukLiIpCiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7cGF0aDogJy9yb2xlcyd9KQogICAgICAgIH0pCiAgICB9CgogIH0sCiAgY3JlYXRlZCgpIHsKICAgIGlmICh0aGlzLmlkKSB7CiAgICAgIFJvbGVBcGkuZ2V0Um9sZSh0aGlzLmlkKS50aGVuKGFzeW5jIHJlc3VsdCA9PiB7CiAgICAgICAgdGhpcy5yb2xlID0gcmVzdWx0LmRhdGE7CiAgICAgICAgdGhpcy5jb3BpZWRSb2xlID0gXy5jbG9uZURlZXAodGhpcy5yb2xlKQoKICAgICAgICB0aGlzLnNlbGVjdGVkRW5kcG9pbnQgPSB0aGlzLnJvbGUucm9sZUVuZHBvaW50cz8ubWFwKHJlID0+IHJlLmlkKT8/W10KICAgICAgICBjb25zdCBmbGF0TWVudXMgPSAocmVzdWx0KSA9PiB7CiAgICAgICAgICBsZXQgY2hpbGRyZW4gPSBbXTsKICAgICAgICAgIGNvbnN0IGZsYXR0ZW5NZW51cyA9IHJlc3VsdC5tYXAobSA9PiB7CiAgICAgICAgICAgIGlmIChtLmNoaWxkTWVudXMgJiYgbS5jaGlsZE1lbnVzLmxlbmd0aCkgewogICAgICAgICAgICAgIGNoaWxkcmVuID0gWy4uLmNoaWxkcmVuLCAuLi5tLmNoaWxkTWVudXNdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBtOwogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuIGZsYXR0ZW5NZW51cy5jb25jYXQoY2hpbGRyZW4ubGVuZ3RoID8gZmxhdE1lbnVzKGNoaWxkcmVuKSA6IGNoaWxkcmVuKTsKICAgICAgICB9OwoKICAgICAgICBpZih0aGlzLnJvbGUuaWQgPT09IDEpIHsKICAgICAgICAgIC8vIGNvbnN0IG1lbnVzID0gYXdhaXQgTWVudUFwaS5maW5kTWVudXNCeUNhdGVnb3J5KCdIT01FJyk7CiAgICAgICAgICBjb25zdCB1c2VyTWVudXMgPSBhd2FpdCBNZW51QXBpLmZpbmRNZW51c0J5Q2F0ZWdvcnkoJ0hPTUUnKTsKICAgICAgICAgIGNvbnN0IGFkbWluTWVudXMgPSBhd2FpdCBNZW51QXBpLmZpbmRNZW51c0J5Q2F0ZWdvcnkoJ0FETUlOJyk7CiAgICAgICAgICB0aGlzLnNlbGVjdGVkVXNlck1lbnUgPSBmbGF0TWVudXModXNlck1lbnVzKS5tYXAobSA9PiB7CiAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgbWVudUlkOiBtLmlkCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgICB0aGlzLnNlbGVjdGVkQWRtaW5NZW51ID0gZmxhdE1lbnVzKGFkbWluTWVudXMpLm1hcChtID0+IHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBtZW51SWQ6IG0uaWQKICAgICAgICAgICAgfQogICAgICAgICAgfSkKCiAgICAgICAgICBjb25zdCB0ZW1wUG9saWNpZXMgPSAoYXdhaXQgUG9saWN5QXBpLmZpbmRQb2xpY2llcyh7c2l6ZTotMX0pKS5jb250ZW50OwogICAgICAgICAgdGhpcy5zZWxlY3RlZFBvbGljeSA9IHRlbXBQb2xpY2llcy5tYXAocCA9PiB7IHJldHVybiB7J2lkJzogcC5pZH0gfSkKCiAgICAgICAgICAvLyBQb2xpY3lBcGkuZmluZFBvbGljaWVzKHtzaXplOi0xfSkudGhlbihhc3luYyBkYXRhID0+IHsKICAgICAgICAgIC8vICAgIHRoaXMuc2VsZWN0ZWRQb2xpY3kgPSBhd2FpdCBkYXRhLmNvbnRlbnQubWFwKHAgPT4geyByZXR1cm4geydpZCc6IHAuaWR9IH0pCiAgICAgICAgICAvLyB9KQoKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJNZW51ID0gdGhpcy5yb2xlLnJvbGVIb21lTWVudUlkcz8ubWFwKGlkID0+IHtyZXR1cm4ge21lbnVJZDogaWR9fSkgPz8gW10KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRBZG1pbk1lbnUgPSB0aGlzLnJvbGUucm9sZUFkbWluTWVudUlkcz8ubWFwKGlkID0+IHtyZXR1cm4ge21lbnVJZDogaWR9fSkgPz8gW10KICAgICAgICAgIHRoaXMuc2VsZWN0ZWRQb2xpY3kgPSB0aGlzLnJvbGUucm9sZVBvbGljaWVzPy5tYXAocmUgPT4ge3JldHVybiB7J2lkJyA6IHJlLmlkLnBvbGljeUlkfX0pPz9bXQoKICAgICAgICAgIC8vIHRoaXMuc2VsZWN0ZWRBZG1pbk1lbnUgPSBfLmNsb25lRGVlcCh0aGlzLnNlbGVjdGVkVXNlck1lbnUpCiAgICAgICAgfQoKICAgICAgICB0aGlzLmNvcGllZFNlbGVjdGVkRW5kcG9pbnQgPSBfLmNsb25lRGVlcCh0aGlzLnNlbGVjdGVkRW5kcG9pbnQpCiAgICAgICAgdGhpcy5jb3BpZWRTZWxlY3RlZFBvbGljeSA9IF8uY2xvbmVEZWVwKHRoaXMuc2VsZWN0ZWRQb2xpY3kpCiAgICAgICAgdGhpcy5jb3BpZWRVc2VyU2VsZWN0ZWRNZW51ID0gXy5jbG9uZURlZXAodGhpcy5zZWxlY3RlZFVzZXJNZW51KQogICAgICAgIHRoaXMuY29waWVkQWRtaW5TZWxlY3RlZE1lbnUgPSBfLmNsb25lRGVlcCh0aGlzLnNlbGVjdGVkQWRtaW5NZW51KQogICAgICB9KQogICAgfQoKICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuJHN0b3JlLnN0YXRlLnVzZXIpCiAgfQoKCn07Cg=="},{"version":3,"sources":["RoleForm.vue"],"names":[],"mappings":";;AA6HA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA","file":"RoleForm.vue","sourceRoot":"src/apps/role","sourcesContent":["<template>\n  <div class=\"flex-grow-1\">\n    <div class=\"d-flex align-center py-3\">\n      <div>\n        <div class=\"display-1\">역할 관리 {{ role.roleName && `- ${role.roleName}` }}</div>\n        <v-breadcrumbs :items=\"breadcrumbs\" class=\"pa-0 py-2\"></v-breadcrumbs>\n      </div>\n      <v-spacer></v-spacer>\n<!--      <v-btn @click=\"saveRole\">{{ this.role.roleId != null ? '수정' : '추가' }}</v-btn>-->\n      <v-btn dark color=\"red\" @click=\"deleteRole\" v-if=\"this.id\"><v-icon left>mdi mdi-delete</v-icon>삭제</v-btn>\n      <v-btn @click=\"resetRole\" style=\"margin-left:1rem\">\n        <v-icon left>mdi-refresh</v-icon>리셋\n      </v-btn>\n      <v-btn dark color=\"indigo\" @click=\"saveRole\" style=\"margin-left:1rem\"><v-icon left>mdi mdi-content-save</v-icon>저장</v-btn>\n      <v-btn @click=\"goToList\" style=\"margin-left:1rem\"><v-icon left>mdi mdi-format-list-bulleted</v-icon>목록</v-btn>\n    </div>\n\n    <v-card class=\"mb-4\">\n      <v-card-title>기본 정보\n\n        <v-spacer></v-spacer>\n        <v-icon small color=\"primary\" v-if=\"role.manager\">mdi-security</v-icon>\n        <span class=\"ma-1\" v-if=\"role.manager\">관리자 권한</span>\n\n      </v-card-title>\n\n      <v-card-text>\n        <v-form ref=\"roleForm\">\n        <div class=\"d-flex\">\n            <v-col>\n              <span class=\"font-weight-bold\">사용 여부</span>\n              <span class=\"mx-1\">\n                  <v-switch\n                    v-model=\"role.activated\"\n                    flat\n                    dense\n                    :label=\"role.activated ?'사용':'사용안함'\"\n                  ></v-switch>\n              </span>\n            </v-col>\n            <v-col>\n              <span class=\"font-weight-bold\">역할 타입</span>\n              <span class=\"mx-1\">\n                  <v-switch\n                    v-model=\"role.manager\"\n                    flat\n                    dense\n                    :label=\"role.manager ?'관리자':'사용자'\"\n                  ></v-switch>\n              </span>\n            </v-col>\n            <v-col sm=\"8\">\n              <span class=\"font-weight-bold\"></span>\n              <span class=\"mx-3 sm6\">\n                  <v-text-field\n                    v-model=\"role.roleName\"\n                    label=\"역할명을 입력해 주세요\"\n                    :rules=\"[rules.common.required]\"\n                    inverted\n                    clearable\n                    dense\n                  ></v-text-field>\n              </span>\n            </v-col>\n          </div>\n          </v-form>\n      </v-card-text>\n    </v-card>\n\n    <v-tabs v-model=\"tab\" :show-arrows=\"false\" background-color=\"transparent\">\n      <v-tab href=\"#tabs-endpoint\">기능 접근 권한</v-tab>\n      <v-tab href=\"#tabs-policy\">기능 사용 정책</v-tab>\n      <v-tab href=\"#tabs-user-menu\">사용자 메뉴 권한</v-tab>\n      <v-tab href=\"#tabs-admin-menu\">관리자 메뉴 권한</v-tab>\n    </v-tabs>\n\n    <v-tabs-items v-model=\"tab\">\n      <v-tab-item value=\"tabs-endpoint\">\n        <Endpoints ref=\"tabs-endpoint\" @callback-save-event=\"saveRole\"\n                   :selectedEndpoint=\"selectedEndpoint\"\n                   :headers=\"endpointHeader\"\n        ></Endpoints>\n      </v-tab-item>\n\n      <v-tab-item value=\"tabs-policy\">\n        <Policies ref=\"tabs-policy\" @callback-save-event=\"saveRole\"\n                   :selectedPolicy=\"selectedPolicy\"\n                   :headers=\"policyHeader\"\n        ></Policies>\n      </v-tab-item>\n\n      <v-tab-item value=\"tabs-user-menu\">\n        <Menus ref=\"tabs-user-menu\" @callback-save-event=\"saveRole\"\n                   :selectedMenu=\"selectedUserMenu\"\n        ></Menus>\n      </v-tab-item>\n\n      <v-tab-item value=\"tabs-admin-menu\">\n        <Menus ref=\"tabs-admin-menu\" @callback-save-event=\"saveRole\"\n               :selectedMenu=\"selectedAdminMenu\"\n               category=\"ADMIN\"\n        ></Menus>\n      </v-tab-item>\n\n    </v-tabs-items>\n\n    <div class=\"d-flex\" style=\"margin-top:1rem\">\n      <v-spacer></v-spacer>\n      <v-btn dark color=\"red\" @click=\"deleteRole\" v-if=\"this.id\"><v-icon left>mdi mdi-delete</v-icon>삭제</v-btn>\n      <v-btn @click=\"resetRole\" style=\"margin-left:1rem\">\n        <v-icon left>mdi-refresh</v-icon>리셋\n      </v-btn>\n      <v-btn dark color=\"indigo\" @click=\"saveRole\" style=\"margin-left:1rem\"><v-icon left>mdi mdi-content-save</v-icon>저장</v-btn>\n      <v-btn @click=\"goToList\" style=\"margin-left:1rem\"><v-icon left>mdi mdi-format-list-bulleted</v-icon>목록</v-btn>\n\n<!--      <v-btn icon @click=\"resetRole\" style=\"margin-left:1rem\">-->\n<!--        <v-icon>mdi-refresh</v-icon>-->\n<!--      </v-btn>-->\n    </div>\n\n  </div>\n</template>\n\n<script>\n\nimport RoleApi from '../../api/RoleApi'\nimport MenuApi from \"@/api/MenuApi\";\n\nimport rules from \"@/utils/rules\";\n\nimport Endpoints from \"@/components/app/Endpoints\"\nimport Menus from \"@/components/app/Menus\"\nimport Policies from \"@/components/app/Policies\"\n\nimport _ from \"lodash\";\nimport PolicyApi from \"@/api/PolicyApi\";\n\nexport default {\n  components: {\n    Endpoints,\n    Menus,\n    Policies\n  },\n  props: ['id'],\n  data() {\n    return {\n      tab: null,\n      rules,\n      breadcrumbs: [{\n        text: '역할관리',\n        disabled: false,\n        href: '#'\n      }, {\n        text: this.$props.id ? '역할수정' : '역할등록'\n      }],\n      role: {\n      },\n      copiedRole: {},\n      selectedEndpoint: [],\n      selectedPolicy: [],\n      copiedSelectedEndpoint: [],\n      copiedSelectedPolicy: [],\n      selectedUserMenu: [],\n      selectedAdminMenu: [],\n      copiedUserSelectedMenu: [],\n      copiedAdminSelectedMenu: [],\n      endpointHeader: [\n        {text: 'resource title', value: 'resourceDescription', align: 'left'},\n        {text: 'api title', value: 'operationDescription', align: 'left'},\n        {text: 'uri', value: 'uri', align: 'left'},\n        {text: 'http method', value: 'httpMethod', align: 'left'},\n        {text: '공개 여부', value: 'isPublicText'}\n      ],\n      policyHeader: [\n        {text: '정책 그룹 코드', value: 'policyGroupCode', align: 'left'},\n        {text: '정책 코드', value: 'policyCode', align: 'left'},\n        {text: '정책 명', value: 'policyName', align: 'left'}\n      ]\n    }\n  },\n  methods: {\n    async saveRole() {\n      if(this.role.id === 1) {\n        alert(\"관리자 역할은 수정하거나 삭제하실 수 없습니다.\")\n        return false\n      }\n      const isValidRoleForm = await this.$refs.roleForm.validate()\n      if (confirm(\"역할 정보를 저장하시겠습니까?\") && isValidRoleForm) {\n\n        const selectedEndpoint = this.$refs[\"tabs-endpoint\"].selected;\n        this.role.roleEndpoints = selectedEndpoint.map(e => { return {'id': {'uri': e.uri, 'httpMethod':e.httpMethod}}})\n\n        const selectedPolicy = this.$refs[\"tabs-policy\"]?.selected??this.copiedSelectedPolicy.map(p => { return {'id': p.id} })\n        this.role.rolePolicies = selectedPolicy.map(e => { return {'id': {'policyId': e.id}}})\n\n        const selectedAdminMenu = this.$refs[\"tabs-admin-menu\"]?.selected??this.copiedAdminSelectedMenu.map(e => { return {'id':e.menuId}})\n        const selectedUserMenu = this.$refs[\"tabs-user-menu\"]?.selected??this.copiedUserSelectedMenu.map(e => { return {'id':e.menuId}})\n        this.role.roleMenus = [...selectedAdminMenu.map(e => { return {'id': {'menuId':e.id}}}), ...selectedUserMenu.map(e => { return {'id': {'menuId':e.id}}})]\n\n        RoleApi.saveRole(this.role).then(result => {\n          this.role.id = result.id\n          alert(\"저장되었습니다.\")\n          // this.$router.push({path: '/roles'})\n        })\n      }\n    },\n    goToList() {\n      this.$router.push({path: '/roles'})\n    },\n    resetRole() {\n      this.role = _.cloneDeep(this.copiedRole)\n      this.selectedEndpoint = _.cloneDeep(this.copiedSelectedEndpoint)\n      this.selectedPolicy = _.cloneDeep(this.copiedSelectedPolicy)\n      this.selectedUserMenu = _.cloneDeep(this.copiedUserSelectedMenu)\n      this.selectedAdminMenu = _.cloneDeep(this.copiedAdminSelectedMenu)\n    },\n    deleteRole(role) {\n      if(role.id === 1) {\n        alert(\"관리자 역할은 수정하거나 삭제하실 수 없습니다.\")\n        return false\n      }\n      if (confirm('삭제하시겠습니까?'))\n        RoleApi.deleteRole(role.id).then(() => {\n          this.roles = this.roles.filter(r => r !== role)\n          alert(\"삭제되었습니다.\")\n          this.$router.push({path: '/roles'})\n        })\n    }\n\n  },\n  created() {\n    if (this.id) {\n      RoleApi.getRole(this.id).then(async result => {\n        this.role = result.data;\n        this.copiedRole = _.cloneDeep(this.role)\n\n        this.selectedEndpoint = this.role.roleEndpoints?.map(re => re.id)??[]\n        const flatMenus = (result) => {\n          let children = [];\n          const flattenMenus = result.map(m => {\n            if (m.childMenus && m.childMenus.length) {\n              children = [...children, ...m.childMenus];\n            }\n            return m;\n          });\n\n          return flattenMenus.concat(children.length ? flatMenus(children) : children);\n        };\n\n        if(this.role.id === 1) {\n          // const menus = await MenuApi.findMenusByCategory('HOME');\n          const userMenus = await MenuApi.findMenusByCategory('HOME');\n          const adminMenus = await MenuApi.findMenusByCategory('ADMIN');\n          this.selectedUserMenu = flatMenus(userMenus).map(m => {\n            return {\n              menuId: m.id\n            }\n          })\n          this.selectedAdminMenu = flatMenus(adminMenus).map(m => {\n            return {\n              menuId: m.id\n            }\n          })\n\n          const tempPolicies = (await PolicyApi.findPolicies({size:-1})).content;\n          this.selectedPolicy = tempPolicies.map(p => { return {'id': p.id} })\n\n          // PolicyApi.findPolicies({size:-1}).then(async data => {\n          //    this.selectedPolicy = await data.content.map(p => { return {'id': p.id} })\n          // })\n\n        } else {\n          this.selectedUserMenu = this.role.roleHomeMenuIds?.map(id => {return {menuId: id}}) ?? []\n          this.selectedAdminMenu = this.role.roleAdminMenuIds?.map(id => {return {menuId: id}}) ?? []\n          this.selectedPolicy = this.role.rolePolicies?.map(re => {return {'id' : re.id.policyId}})??[]\n\n          // this.selectedAdminMenu = _.cloneDeep(this.selectedUserMenu)\n        }\n\n        this.copiedSelectedEndpoint = _.cloneDeep(this.selectedEndpoint)\n        this.copiedSelectedPolicy = _.cloneDeep(this.selectedPolicy)\n        this.copiedUserSelectedMenu = _.cloneDeep(this.selectedUserMenu)\n        this.copiedAdminSelectedMenu = _.cloneDeep(this.selectedAdminMenu)\n      })\n    }\n\n    // console.log(this.$store.state.user)\n  }\n\n\n};\n</script>\n"]}]}