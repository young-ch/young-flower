{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/components/app/Menus.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/components/app/Menus.vue","mtime":1665531625454},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js","mtime":1665531751248},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBtZW51QXBpIGZyb20gJ0AvYXBpL01lbnVBcGknOwppbXBvcnQgXyBmcm9tICJsb2Rhc2giOwoKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBoZWFkZXJzOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0OiAoKSA9PiAoWwogICAgICAgIHt0ZXh0OiAn66mU64m066qFJywgdmFsdWU6ICdtZW51TmFtZScsIGFsaWduOiAnbGVmdCd9LAogICAgICAgIHt0ZXh0OiAn7KCR6re87KCc7Ja0JywgdmFsdWU6ICdpc1B1YmxpY1RleHQnLCBhbGlnbjogJ2xlZnQnfSwKICAgICAgICB7dGV4dDogJ+yCrOyaqeyXrOu2gCcsIHZhbHVlOiAnaXNBY3RpdmF0ZWRUZXh0JywgYWxpZ246ICdsZWZ0J30sCiAgICAgICAge3RleHQ6ICfrqZTribTtg4DsnoUnLCB2YWx1ZTogJ21lbnVUeXBlVGV4dCcsIGFsaWduOiAnbGVmdCd9LAogICAgICAgIHt0ZXh0OiAn7IOd7ISx7J28JywgdmFsdWU6ICdjcmVhdGVkQXQnLCBhbGlnbjogJ2xlZnQnfSwKICAgICAgICAvLyB7dGV4dDogJ+yXsOqysO2UhOuhnOq3uOueqCcsIHZhbHVlOiAnY29ubmVjdGVkUHJvZ3JhbScsIGFsaWduOiAnbGVmdCd9CiAgICAgIF0pCiAgICB9LAogICAgc2VsZWN0ZWRNZW51OiB7CiAgICAgIHR5cGU6IEFycmF5CiAgICB9LAogICAgY2F0ZWdvcnk6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiAnSE9NRScKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICAvLyBzZWxlY3RlZE1lbnU6IHsKICAgIC8vICAgaGFuZGxlcihudikgewogICAgLy8gICAgIHRoaXMuc2VsZWN0ZWQgPSBudi5tYXAodiA9PiB7CiAgICAvLyAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih2LCB7J2lkJyA6IHYubWVudUlkfSkKICAgIC8vICAgICB9KT8/W10KICAgIC8vICAgICAvLyBjb25zb2xlLmxvZyhudikKICAgIC8vICAgfQogICAgLy8gfSwKICAgIHNlYXJjaFNlbGVjdGVkOiB7CiAgICAgIGhhbmRsZXIobnYpIHsKICAgICAgICBjb25zb2xlLmxvZyhudikKICAgICAgICBpZihudikgewogICAgICAgICAgdGhpcy5jb3BpZWRNZW51cyA9IF8uY2xvbmVEZWVwKHRoaXMubWVudXMpCiAgICAgICAgICB0aGlzLm1lbnVzID0gdGhpcy5tZW51cy5maWx0ZXIoZSA9PiB0aGlzLnNlbGVjdGVkLm1hcChzID0+IHMuaWQpLmluY2x1ZGVzKGUuaWQpKQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLm1lbnVzID0gXy5jbG9uZURlZXAodGhpcy5jb3BpZWRNZW51cykKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzZWFyY2hTZWxlY3RlZDogZmFsc2UsCiAgICAgIHNlYXJjaDogJycsCiAgICAgIC8vIGhlYWRlcnM6ICwKICAgICAgb3B0aW9uczogewogICAgICAgIHBhZ2U6IDEsCiAgICAgICAgaXRlbXNQZXJQYWdlOiAtMQogICAgICB9LAogICAgICBzZWxlY3RlZDogW10sCiAgICAgIG1lbnVzOiBbXSwKICAgICAgY29waWVkTWVudXM6IFtdLAogICAgICB0b3RhbENvdW50OiBudWxsLAogICAgICBydWxlczogewogICAgICB9LAogICAgICBpbml0OiBmYWxzZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgc2F2ZUV2ZW50KCkgewogICAgICB0aGlzLiRlbWl0KCdjYWxsYmFjay1zYXZlLWV2ZW50JywgdGhpcy5zZWxlY3RlZCk7CiAgICB9LAogICAgYXN5bmMgZmluZE1lbnVzKCkgewoKICAgICAgaWYoIXRoaXMuaW5pdCkgewogICAgICAgIHRoaXMuc2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGVkTWVudS5tYXAodiA9PiB7CiAgICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih2LCB7J2lkJzogdi5tZW51SWR9KQogICAgICAgIH0pID8/IFtdCiAgICAgICAgdGhpcy5pbml0ID0gdHJ1ZQogICAgICB9CgogICAgICBtZW51QXBpLmZpbmRNZW51c0J5Q2F0ZWdvcnkodGhpcy5jYXRlZ29yeSkudGhlbihyZXN1bHQgPT4gewoKICAgICAgICBjb25zdCBmbGF0TWVudXMgPSAocmVzdWx0LCBkZXB0aCkgPT4gewogICAgICAgICAgbGV0IGNoaWxkcmVuID0gW107CiAgICAgICAgICByZXN1bHQuZm9yRWFjaChtID0+IHsKICAgICAgICAgICAgbS5kZXB0aCA9IGRlcHRoCiAgICAgICAgICAgIGNoaWxkcmVuID0gY2hpbGRyZW4uY29uY2F0KG0sIG0uY2hpbGRNZW51cyA/IGZsYXRNZW51cyhtLmNoaWxkTWVudXMsIGRlcHRoKzEpIDogW10pCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiBjaGlsZHJlbgogICAgICAgIH07CgogICAgICAgIGNvbnN0IHRlbXAgPSBmbGF0TWVudXMocmVzdWx0LCAxKTsKCiAgICAgICAgdGhpcy5tZW51cyA9IHRlbXAubWFwKGVsZSA9PiB7CiAgICAgICAgICAvLyBlbGUuaXNQdWJsaWMgPSAhIXB1YmxpY01lbnVzLmZpbmQocGUgPT4gcGUudXJpID09PSBlbGUudXJpICYmIHBlLmh0dHBNZXRob2QgPT09IGVsZS5odHRwTWV0aG9kKTsKICAgICAgICAgIC8vIGVsZS5uYW1lID0gZWxlLm1lbnVOYW1lCiAgICAgICAgICBlbGUuaXNQdWJsaWNUZXh0ID0gZWxlLmlzUHVibGljID8n6rO16rCcJzon67mE6rO16rCcJwogICAgICAgICAgZWxlLmlzQWN0aXZhdGVkVGV4dCA9IGVsZS5hY3RpdmF0ZWQgPyAn7IKs7JqpJyA6ICfsgqzsmqnslYjtlagnCiAgICAgICAgICBlbGUubWVudVR5cGVUZXh0ID0gZWxlLm1lbnVUeXBlID09PSAnVFlQRV9MSU5LJyA/ICLrp4HtgawiIDogZWxlLm1lbnVUeXBlID09PSAnVFlQRV9CT0FSRCcgPyAi6rKM7Iuc7YyQIiA6ICLsu6jthZDsuKAiCgogICAgICAgICAgcmV0dXJuIGVsZTsKICAgICAgICB9KTsKICAgICAgfSkKCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5maW5kTWVudXMoKTsKICB9Cgp9Owo="},{"version":3,"sources":["Menus.vue"],"names":[],"mappings":";AAyDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"Menus.vue","sourceRoot":"src/components/app","sourcesContent":["<template>\n  <div class=\"d-flex flex-column flex-grow-1\">\n    <v-card>\n      <v-card-title>\n        <v-switch\n          v-model=\"searchSelected\"\n          :label=\"searchSelected ? '선택 메뉴' : '전체 메뉴'\"\n          flat\n        >\n        </v-switch>\n        <v-spacer></v-spacer>\n        <v-text-field\n          v-model=\"search\"\n          append-icon=\"mdi-magnify\"\n          label=\"전체 검색\"\n          single-line\n          hide-details\n          clearable\n        ></v-text-field>\n      </v-card-title>\n\n<!--      <v-treeview-->\n<!--        v-model=\"selected\"-->\n<!--        :items=\"menus\"-->\n<!--        :search=\"search\"-->\n<!--        selection-type=\"independent\"-->\n<!--        selectable-->\n<!--        return-object-->\n<!--        open-all-->\n<!--      ></v-treeview>-->\n\n      <v-data-table\n        v-model=\"selected\"\n        :search=\"search\"\n        :headers=\"headers\"\n        :items=\"menus\"\n        show-select\n        item-key=\"id\"\n        class=\"elevation-1\"\n        sortable=\"false\"\n        :options.sync=\"options\"\n        :footer-props=\"{showFirstLastPage: true, 'items-per-page-options' : [5,10,20,50,100,-1]}\"\n        @click:row=\"(item, row) => row.select(!row.isSelected)\"\n      >\n        <template v-slot:item.menuName=\"{ item, value }\">\n          <div :style=\"`padding-left: ${(item.depth-1)*30}px`\">{{ value }}</div>\n        </template>\n        <template v-slot:item.createdAt=\"{ value }\">\n          <div>{{ value | formatDate('YYYY-MM-DD HH:mm:ss') }}</div>\n        </template>\n      </v-data-table>\n\n    </v-card>\n  </div>\n</template>\n\n<script>\nimport menuApi from '@/api/MenuApi';\nimport _ from \"lodash\";\n\nexport default {\n  props: {\n    headers: {\n      type: Array,\n      default: () => ([\n        {text: '메뉴명', value: 'menuName', align: 'left'},\n        {text: '접근제어', value: 'isPublicText', align: 'left'},\n        {text: '사용여부', value: 'isActivatedText', align: 'left'},\n        {text: '메뉴타입', value: 'menuTypeText', align: 'left'},\n        {text: '생성일', value: 'createdAt', align: 'left'},\n        // {text: '연결프로그램', value: 'connectedProgram', align: 'left'}\n      ])\n    },\n    selectedMenu: {\n      type: Array\n    },\n    category: {\n      type: String,\n      default: 'HOME'\n    }\n  },\n  watch: {\n    // selectedMenu: {\n    //   handler(nv) {\n    //     this.selected = nv.map(v => {\n    //       return Object.assign(v, {'id' : v.menuId})\n    //     })??[]\n    //     // console.log(nv)\n    //   }\n    // },\n    searchSelected: {\n      handler(nv) {\n        console.log(nv)\n        if(nv) {\n          this.copiedMenus = _.cloneDeep(this.menus)\n          this.menus = this.menus.filter(e => this.selected.map(s => s.id).includes(e.id))\n        } else {\n          this.menus = _.cloneDeep(this.copiedMenus)\n        }\n      }\n    }\n  },\n  data() {\n    return {\n      searchSelected: false,\n      search: '',\n      // headers: ,\n      options: {\n        page: 1,\n        itemsPerPage: -1\n      },\n      selected: [],\n      menus: [],\n      copiedMenus: [],\n      totalCount: null,\n      rules: {\n      },\n      init: false\n    }\n  },\n  methods: {\n    saveEvent() {\n      this.$emit('callback-save-event', this.selected);\n    },\n    async findMenus() {\n\n      if(!this.init) {\n        this.selected = this.selectedMenu.map(v => {\n          return Object.assign(v, {'id': v.menuId})\n        }) ?? []\n        this.init = true\n      }\n\n      menuApi.findMenusByCategory(this.category).then(result => {\n\n        const flatMenus = (result, depth) => {\n          let children = [];\n          result.forEach(m => {\n            m.depth = depth\n            children = children.concat(m, m.childMenus ? flatMenus(m.childMenus, depth+1) : [])\n          });\n          return children\n        };\n\n        const temp = flatMenus(result, 1);\n\n        this.menus = temp.map(ele => {\n          // ele.isPublic = !!publicMenus.find(pe => pe.uri === ele.uri && pe.httpMethod === ele.httpMethod);\n          // ele.name = ele.menuName\n          ele.isPublicText = ele.isPublic ?'공개':'비공개'\n          ele.isActivatedText = ele.activated ? '사용' : '사용안함'\n          ele.menuTypeText = ele.menuType === 'TYPE_LINK' ? \"링크\" : ele.menuType === 'TYPE_BOARD' ? \"게시판\" : \"컨텐츠\"\n\n          return ele;\n        });\n      })\n\n    }\n  },\n  created() {\n    this.findMenus();\n  }\n\n};\n</script>\n"]}]}