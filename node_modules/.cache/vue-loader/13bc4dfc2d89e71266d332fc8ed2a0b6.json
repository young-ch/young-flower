{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/components/editor/EditorComponent.vue?vue&type=style&index=0&id=819df744&lang=css&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/components/editor/EditorComponent.vue","mtime":1665531625456},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/css-loader/dist/cjs.js","mtime":1665531751068},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1665531752098},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/postcss-loader/src/index.js","mtime":1665531751243},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmRpdi50dWktcG9wdXAtd3JhcHBlci50ZS1wb3B1cC1hZGQtaW1hZ2UudHVpLWVkaXRvci1wb3B1cCA+IGRpdi50dWktcG9wdXAtYm9keSA+IC50ZS1maWxlLXR5cGUudGUtdGFiLWFjdGl2ZSArIGxhYmVsIHsKICBkaXNwbGF5OiBub25lOwp9CmRpdi50dWktcG9wdXAtd3JhcHBlci50ZS1wb3B1cC1hZGQtaW1hZ2UudHVpLWVkaXRvci1wb3B1cCA+IGRpdi50dWktcG9wdXAtYm9keSA+IC50ZS1maWxlLXR5cGUudGUtdGFiLWFjdGl2ZSArIGxhYmVsICsgaW5wdXQgewogIGRpc3BsYXk6IG5vbmU7Cn0KLnR1aS1lZGl0b3ItcG9wdXAgLnR1aS1wb3B1cC1ib2R5IGlucHV0W3R5cGU9J3RleHQnXSwgLnR1aS1lZGl0b3ItcG9wdXAgLnR1aS1wb3B1cC1ib2R5IGlucHV0W3R5cGU9J2ZpbGUnXSB7CiAgY29sb3I6ICMxMTFiMjc7Cn0K"},{"version":3,"sources":["EditorComponent.vue"],"names":[],"mappings":";AAiMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EditorComponent.vue","sourceRoot":"src/components/editor","sourcesContent":["<template>\n<section>\n  <v-row>\n    <v-col class=\"mgr\" >\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn color=\"blue darken-1\" text @click=\"enableHtmlMode\">HTML</v-btn>\n        <v-btn color=\"blue darken-1\" text @click=\"disableHtmlMode\">EDITOR</v-btn>\n      </v-card-actions>\n    </v-col>\n  </v-row>\n  <v-row v-if=\"editorMode\">\n    <v-col class=\"mgr\">\n      <editor ref=\"teditor\" :options=\"editorComputedOptions()\" initialEditType=\"wysiwyg\"/>\n    </v-col>\n  </v-row>\n  <v-row  v-else>\n    <v-col class=\"mgr\">\n      <v-textarea v-model=\"html\" :rules=\"[rules.required]\" :label=\"label\" :auto-grow=\"false\" rows=\"10\"></v-textarea>\n    </v-col>\n  </v-row>\n</section>\n</template>\n\n<script>\nimport '@toast-ui/editor/dist/toastui-editor.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'tui-color-picker/dist/tui-color-picker.css';\nimport colorSyntax from '@toast-ui/editor-plugin-color-syntax';\n\nimport {Editor} from '@toast-ui/vue-editor';\nimport _ from 'lodash';\n\nconst beautify_html = require('js-beautify').html;\n\nexport default {\n  name: \"EditorComponent\",\n  components: {\n    Editor\n  },\n  props: {\n    val:String,\n    label:{\n      type:String,\n      default:\"컨텐츠 내용\"\n    },\n    uploaded: Object\n  },\n  methods: {\n    editorComputedOptions() {\n      const _this = this;\n      const options = Object.assign({}, this.editorOptions, this.options);\n      options.hooks = {};\n      options.initialEditType = _this.mode;\n      options.height = _this.height;\n      options.language = _this.language;\n      options.placeholder = _this.placeholder;\n      options.hooks.addImageBlobHook = _this.uploadImage;\n      options.plugins = [colorSyntax]\n\n      return options;\n    },\n    // uploadImage(fileOrBlob, cb, source) {\n    uploadImage(fileOrBlob) {\n      // let imageUrl = URL.createObjectURL(fileOrBlob);\n      // cb(imageUrl, \"description\");\n\n      this.$emit('callback-upload', fileOrBlob);\n\n      // this.uploadFunction(fileOrBlob).then(res => {\n      //\n      //   const { url, desc } = res;\n      //   this.html += `<p><img src=\"${this.ATTACH_PATH + url}\" alt=\"${desc}\"/></p>`\n      //   this.$refs.teditor?.invoke(\"setHtml\", this.html ?? '');\n      //\n      //   console.log(cb);\n      //   console.log(source);\n      //   // cb(this.ATTACH_PATH + url, \"description\");\n      // });\n    },\n    uploadComplete() {\n      if(this.editorMode)\n        this.html = this.getEditorHtml();\n\n      this.html += `<p><img src=\"${this.ATTACH_PATH}${this.uploaded.contextPath}${this.uploaded.saveName}\" alt=\"${this.uploaded.clientName}\"/></p>`\n      this.$nextTick(() => {\n        this.$refs.teditor?.invoke(\"setHtml\", this.html, false);\n      });\n      // this.$refs.teditor?.invoke(\"setHtml\", this.html ?? '');\n    },\n    enableHtmlMode() {\n      if(!this.editorMode)\n        return\n\n      // console.log(document.getElementsByClassName(\"tui-editor-contents\")[0].innerHTML);\n      // console.log(document.getElementsByClassName(\"tui-editor-contents\")[0]);\n\n\n      // for (var i = 0; i < editorContents.length; i++) {\n      //   console.log(editorContents[i].innerHTML);\n      // }\n      this.$nextTick(() => {\n        // this.$emit('callback-html', this.$refs.teditor.invoke(\"getHtml\"));\n        // this.html = this.$refs.teditor.invoke(\"getHtml\");\n        // this.html = document.getElementsByClassName(\"tui-editor-contents\")[0];\n        // console.log(document.getElementsByClassName('te-ww-container')[0]?.childNodes[0]?.childNodes??'');\n        // console.log([...editorContents].map(c => c.innerHTML));\n        // console.log(editorContents);\n\n        this.html = beautify_html(this.getEditorHtml());\n        console.log(this.html)\n      });\n      this.editorMode = false;\n\n    },\n    disableHtmlMode() {\n      if(this.editorMode)\n        return\n\n      // this.$emit('callback-editor');\n\n      this.editorMode = true;\n\n      this.$nextTick(() => {\n        this.$refs?.teditor?.invoke(\"setHtml\", this.html, false);\n      });\n    },\n    getValue() {\n      if(this.editorMode)\n        this.html = this.getEditorHtml();\n      return this.html;\n      // return this.editorMode ? this.$refs.teditor.invoke(\"getHtml\") : this.html;\n    },\n    getEditorHtml() {\n      return [...document.getElementsByClassName('te-ww-container')[0]?.childNodes[0]?.childNodes ?? []].filter(c => c.className.indexOf(\"tui-editor-contents\") !== -1)?.[0]?.innerHTML ?? '';\n    }\n  },\n  watch: {\n    val: function(v) {\n      this.html = _.cloneDeep(v);\n      this.$nextTick(() => {\n        this.$refs.teditor?.invoke(\"setHtml\", this.html ?? '');\n      });\n      this.editorMode = true;\n    },\n    uploaded: function(v) {\n      if(v && Object.keys(v).length > 0) {\n        this.uploadComplete();\n      }\n    }\n  },\n  data: () => ({\n    ATTACH_PATH:process.env.VUE_APP_ATTACH_FILE_SERVER_URL,\n    editorOptions:{\n      minHeight: '200px',\n      language: 'en_US',\n      useCommandShortcut: true,\n      useDefaultHTMLSanitizer: true,\n      usageStatistics: true,\n      hideModeSwitch: false,\n      previewStyle: 'vertical',\n      toolbarItems: [\n        'heading',\n        'bold',\n        'italic',\n        'strike',\n        'divider',\n        'hr',\n        'quote',\n        'divider',\n        'ul',\n        'ol',\n        'task',\n        'indent',\n        'outdent',\n        'divider',\n        'table',\n        'image',\n        'link',\n        'divider',\n        'code',\n        'codeblock'\n      ]\n    },\n    html:'',\n    rules: {\n      required: value => !!value || '필수 입력 항목입니다..'\n    },\n    editorMode: true\n  })\n}\n</script>\n<style>\ndiv.tui-popup-wrapper.te-popup-add-image.tui-editor-popup > div.tui-popup-body > .te-file-type.te-tab-active + label {\n  display: none;\n}\ndiv.tui-popup-wrapper.te-popup-add-image.tui-editor-popup > div.tui-popup-body > .te-file-type.te-tab-active + label + input {\n  display: none;\n}\n.tui-editor-popup .tui-popup-body input[type='text'], .tui-editor-popup .tui-popup-body input[type='file'] {\n  color: #111b27;\n}\n</style>\n<style scoped>\n</style>\n"]}]}