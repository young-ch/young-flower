{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/user/UserHistory.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/apps/user/UserHistory.vue","mtime":1665531625452},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js","mtime":1665531751248},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBydWxlcyBmcm9tICJAL3V0aWxzL3J1bGVzIjsKaW1wb3J0IFVzZXJBcGkgZnJvbSAiQC9hcGkvVXNlckFwaSI7CmltcG9ydCBjb25maWcgZnJvbSAiQC9jb25maWdzIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOid1c2VySGlzdG9yeScsCiAgcHJvcHM6WydpZCddLAogIGNvbXBvbmVudHM6IHsKICB9LAogIGRhdGE6ICgpID0+ICh7CiAgICBpc0xvYWRpbmc6IGZhbHNlLAogICAgaGVhZGVyczogWwogICAgICB7dGV4dDogJ+ydvOugqCDrsojtmLgnLCBhbGlnbjogJ2xlZnQnLCB2YWx1ZTogJ25vJ30sCiAgICAgIHt0ZXh0OiAn7J2066ClIOuyiO2YuCcsIGFsaWduOiAnbGVmdCcsIHZhbHVlOiAnaWQnfSwKICAgICAge3RleHQ6ICfsiJjsoJXsnpAg67KI7Zi4JywgYWxpZ246ICdsZWZ0JywgdmFsdWU6ICdmcm9tSWQnfSwKICAgICAge3RleHQ6ICftmZzrj5kg64K07JetJywgYWxpZ246ICdsZWZ0JywgdmFsdWU6ICd1c2VyQWN0aW9uJ30sCiAgICAgIHt0ZXh0OiAn7JWE7J207ZS8JywgdmFsdWU6ICdpcCd9LAogICAgICB7dGV4dDogJ+2ZnOuPmSDsnbzsi5wnLCB2YWx1ZTogJ2NyZWF0ZWRBdCd9LAogICAgICB7IHRleHQ6ICcnLCB2YWx1ZTogJ2RhdGEtdGFibGUtZXhwYW5kJyB9CiAgICAgIC8vIHt0ZXh0OiAn6rSA66asJywgc29ydGFibGU6IGZhbHNlLCB2YWx1ZTogJ2FjdGlvbnMnfQogICAgXSwKICAgIG9wdGlvbnM6IHt9LAogICAgcGFyYW06IHsKICAgICAgc2VhcmNoS2V5d29yZDogbnVsbCwKICAgICAgcGFnZTogMQogICAgfSwKICAgIHRvdGFsSXRlbXM6IDAsCiAgICBsaXN0TGluazonL3VzZXJzJywKICAgIHJ1bGVzLAogICAgc3RhdGVzOmNvbmZpZy5tZXRhLnVzZXIuc3RhdGUsCiAgICBzeXN0ZW1zOmNvbmZpZy5tZXRhLnN5c3RlbXMsCiAgICBtZXNzYWdlOnsKICAgICAgZXJyb3I6JycsCiAgICAgIGVycm9yRW1haWw6JycsCiAgICAgIGVycm9yU3lzdGVtOm51bGwsCiAgICAgIHN1Y2Nlc3M6JycsCiAgICAgIHN1Y2Nlc3NFbWFpbDonJywKICAgIH0sCiAgICBoaXN0b3J5TGlzdDogW10sCiAgfSksCiAgd2F0Y2g6IHsKICAgIG9wdGlvbnM6IHsKICAgICAgaGFuZGxlciAoKSB7CiAgICAgICAgdGhpcy5nZXRIaXN0b3J5KCk7CiAgICAgIH0sCiAgICAgIGRlZXA6IHRydWUsCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogIH0sCiAgbWV0aG9kczogewogICAgZ2V0SGlzdG9yeShzdG9yZWRQYXJhbXMpIHsKICAgICAgY29uc3QgeyAgcGFnZSwgaXRlbXNQZXJQYWdlLCBzaXplIH0gPSB0aGlzLm9wdGlvbnM7CiAgICAgIGxldCBwYXJhbXMgPSB7Li4udGhpcy5wYXJhbSwgLi4uewogICAgICAgICAgcGFnZTogcGFnZSwKICAgICAgICAgIHNpemU6IGl0ZW1zUGVyUGFnZSA/IGl0ZW1zUGVyUGFnZSA6IHNpemUsCiAgICAgICAgICBpdGVtc1BlclBhZ2UKICAgICAgICB9fTsKCiAgICAgIFVzZXJBcGkuZ2V0VXNlckhpc3RvcnkodGhpcy5pZCwgcGFyYW1zKS50aGVuKGRhdGEgPT4gewogICAgICAgIHRoaXMuaGlzdG9yeUxpc3QgPSBkYXRhLmNvbnRlbnQKICAgICAgICB0aGlzLnRvdGFsSXRlbXMgPSBkYXRhLnRvdGFsRWxlbWVudHMKCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCdzZXRQYXJhbXMnLCBwYXJhbXMpCiAgICAgIH0pCiAgICB9CiAgfSwKICBhc3luYyBjcmVhdGVkKCkgewogICAgbGV0IHN0b3JlZFBhcmFtcyA9IHRoaXMuJHN0b3JlLmdldHRlcnM/LnBhcmFtcz8/e307CgogICAgLy8gZmlyc3QgbG9hZAogICAgaWYoIXN0b3JlZFBhcmFtcy5uYW1lIHx8IHN0b3JlZFBhcmFtcy5uYW1lICE9PSB0aGlzLiRvcHRpb25zLm5hbWUpIHsKICAgICAgdGhpcy5vcHRpb25zID0gewogICAgICAgIHBhZ2U6MSwKICAgICAgICBpdGVtc1BlclBhZ2U6MTIsCiAgICAgICAgc2VhcmNoS2V5d29yZDpudWxsLAogICAgICAgIG5hbWU6dGhpcy4kb3B0aW9ucy5uYW1lCiAgICAgIH0KCiAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgnc2V0UGFyYW1zJywgT2JqZWN0LmFzc2lnbih0aGlzLnBhcmFtLCB7bmFtZTp0aGlzLiRvcHRpb25zLm5hbWV9KSkKCiAgICB9IGVsc2UgewoKICAgICAgdGhpcy5vcHRpb25zID0gc3RvcmVkUGFyYW1zCiAgICAgIHRoaXMucGFyYW0gPSBzdG9yZWRQYXJhbXMKCiAgICB9CgogICAgYXdhaXQgdGhpcy5nZXRIaXN0b3J5KCk7CgogIH0KfQo="},{"version":3,"sources":["UserHistory.vue"],"names":[],"mappings":";AAiEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA","file":"UserHistory.vue","sourceRoot":"src/apps/user","sourcesContent":["<template>\n  <div>\n    <v-card class=\"my-2\">\n      <v-card-title>활동 이력</v-card-title>\n      <v-card-text>\n        <v-data-table\n          :headers=\"headers\"\n          :items=\"historyList\"\n          :server-items-length=\"totalItems\"\n          :options.sync=\"options\"\n          item-key=\"id\"\n          :footer-props=\"{showFirstLastPage: true, 'items-per-page-options' : [12,20,50,100,-1], showCurrentPage:true}\"\n          class=\"flex-grow-1\"\n          disable-sort\n          show-expand\n          single-expand\n        >\n          <!--        :search=\"searchKeyword\"-->\n          <template v-slot:item.no=\"{ index }\">\n            <div>{{totalItems - ((options.page-1) * (options.itemsPerPage === -1 ? 0 : options.itemsPerPage)) - index}}</div>\n          </template>\n          <template v-slot:item.createdAt=\"{ value }\">\n            <div>{{ value | formatDate('YYYY-MM-DD HH:mm:ss') }}</div>\n          </template>\n\n<!--          <template v-slot:item.actions=\"{ item }\">-->\n<!--            <div class=\"actions\">-->\n<!--              -->\n<!--            </div>-->\n<!--          </template>-->\n\n          <template v-slot:expanded-item=\"{ headers, item }\">\n            <td :colspan=\"headers.length\">\n              {{ item.actionDescribed }}\n            </td>\n          </template>\n\n          <template #footer.page-text=\"props\">\n\n            <v-combobox\n              v-model=\"options.page\"\n              :label=\"`${props.pageStart}-${props.pageStop} of ${props.itemsLength} rows / ${options.page} page / total ${Math.ceil(props.itemsLength / options.itemsPerPage)} pages`\"\n              :items=\"Array.from({length: Math.ceil(props.itemsLength / options.itemsPerPage)}, (v, k) => k+1 )\"\n              :return-object=\"false\"\n              hide-details dense\n              type=\"number\"\n              suffix=\"page\"\n            >\n            </v-combobox>\n          </template>\n        </v-data-table>\n      </v-card-text>\n\n    </v-card>\n\n    <div class=\"d-flex align-center\">\n      <v-spacer></v-spacer>\n      <v-btn @click=\"$router.push(listLink)\" style=\"margin-left:1rem\">\n        <v-icon left>mdi mdi-format-list-bulleted</v-icon>\n        목록</v-btn>\n    </div>\n  </div>\n</template>\n\n<script>\nimport rules from \"@/utils/rules\";\nimport UserApi from \"@/api/UserApi\";\nimport config from \"@/configs\";\n\nexport default {\n  name:'userHistory',\n  props:['id'],\n  components: {\n  },\n  data: () => ({\n    isLoading: false,\n    headers: [\n      {text: '일련 번호', align: 'left', value: 'no'},\n      {text: '이력 번호', align: 'left', value: 'id'},\n      {text: '수정자 번호', align: 'left', value: 'fromId'},\n      {text: '활동 내역', align: 'left', value: 'userAction'},\n      {text: '아이피', value: 'ip'},\n      {text: '활동 일시', value: 'createdAt'},\n      { text: '', value: 'data-table-expand' }\n      // {text: '관리', sortable: false, value: 'actions'}\n    ],\n    options: {},\n    param: {\n      searchKeyword: null,\n      page: 1\n    },\n    totalItems: 0,\n    listLink:'/users',\n    rules,\n    states:config.meta.user.state,\n    systems:config.meta.systems,\n    message:{\n      error:'',\n      errorEmail:'',\n      errorSystem:null,\n      success:'',\n      successEmail:'',\n    },\n    historyList: [],\n  }),\n  watch: {\n    options: {\n      handler () {\n        this.getHistory();\n      },\n      deep: true,\n    }\n  },\n  computed: {\n  },\n  methods: {\n    getHistory(storedParams) {\n      const {  page, itemsPerPage, size } = this.options;\n      let params = {...this.param, ...{\n          page: page,\n          size: itemsPerPage ? itemsPerPage : size,\n          itemsPerPage\n        }};\n\n      UserApi.getUserHistory(this.id, params).then(data => {\n        this.historyList = data.content\n        this.totalItems = data.totalElements\n\n        this.$store.commit('setParams', params)\n      })\n    }\n  },\n  async created() {\n    let storedParams = this.$store.getters?.params??{};\n\n    // first load\n    if(!storedParams.name || storedParams.name !== this.$options.name) {\n      this.options = {\n        page:1,\n        itemsPerPage:12,\n        searchKeyword:null,\n        name:this.$options.name\n      }\n\n      this.$store.commit('setParams', Object.assign(this.param, {name:this.$options.name}))\n\n    } else {\n\n      this.options = storedParams\n      this.param = storedParams\n\n    }\n\n    await this.getHistory();\n\n  }\n}\n</script>\n<style lang=\"scss\">\n\n</style>\n"]}]}