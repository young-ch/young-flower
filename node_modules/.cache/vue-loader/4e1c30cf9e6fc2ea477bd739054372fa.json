{"remainingRequest":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/components/editor/EditorComponent.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/src/components/editor/EditorComponent.vue","mtime":1665531625456},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/babel-loader/lib/index.js","mtime":1665531751248},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/cache-loader/dist/cjs.js","mtime":1665531750829},{"path":"/Users/youngchelchoi/Desktop/workspace/flower/flower-backoffice/node_modules/vue-loader/lib/index.js","mtime":1665531752006}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCAnQHRvYXN0LXVpL2VkaXRvci9kaXN0L3RvYXN0dWktZWRpdG9yLmNzcyc7CmltcG9ydCAnY29kZW1pcnJvci9saWIvY29kZW1pcnJvci5jc3MnOwppbXBvcnQgJ3R1aS1jb2xvci1waWNrZXIvZGlzdC90dWktY29sb3ItcGlja2VyLmNzcyc7CmltcG9ydCBjb2xvclN5bnRheCBmcm9tICdAdG9hc3QtdWkvZWRpdG9yLXBsdWdpbi1jb2xvci1zeW50YXgnOwoKaW1wb3J0IHtFZGl0b3J9IGZyb20gJ0B0b2FzdC11aS92dWUtZWRpdG9yJzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKCmNvbnN0IGJlYXV0aWZ5X2h0bWwgPSByZXF1aXJlKCdqcy1iZWF1dGlmeScpLmh0bWw7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkVkaXRvckNvbXBvbmVudCIsCiAgY29tcG9uZW50czogewogICAgRWRpdG9yCiAgfSwKICBwcm9wczogewogICAgdmFsOlN0cmluZywKICAgIGxhYmVsOnsKICAgICAgdHlwZTpTdHJpbmcsCiAgICAgIGRlZmF1bHQ6Iuy7qO2FkOy4oCDrgrTsmqkiCiAgICB9LAogICAgdXBsb2FkZWQ6IE9iamVjdAogIH0sCiAgbWV0aG9kczogewogICAgZWRpdG9yQ29tcHV0ZWRPcHRpb25zKCkgewogICAgICBjb25zdCBfdGhpcyA9IHRoaXM7CiAgICAgIGNvbnN0IG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCB0aGlzLmVkaXRvck9wdGlvbnMsIHRoaXMub3B0aW9ucyk7CiAgICAgIG9wdGlvbnMuaG9va3MgPSB7fTsKICAgICAgb3B0aW9ucy5pbml0aWFsRWRpdFR5cGUgPSBfdGhpcy5tb2RlOwogICAgICBvcHRpb25zLmhlaWdodCA9IF90aGlzLmhlaWdodDsKICAgICAgb3B0aW9ucy5sYW5ndWFnZSA9IF90aGlzLmxhbmd1YWdlOwogICAgICBvcHRpb25zLnBsYWNlaG9sZGVyID0gX3RoaXMucGxhY2Vob2xkZXI7CiAgICAgIG9wdGlvbnMuaG9va3MuYWRkSW1hZ2VCbG9iSG9vayA9IF90aGlzLnVwbG9hZEltYWdlOwogICAgICBvcHRpb25zLnBsdWdpbnMgPSBbY29sb3JTeW50YXhdCgogICAgICByZXR1cm4gb3B0aW9uczsKICAgIH0sCiAgICAvLyB1cGxvYWRJbWFnZShmaWxlT3JCbG9iLCBjYiwgc291cmNlKSB7CiAgICB1cGxvYWRJbWFnZShmaWxlT3JCbG9iKSB7CiAgICAgIC8vIGxldCBpbWFnZVVybCA9IFVSTC5jcmVhdGVPYmplY3RVUkwoZmlsZU9yQmxvYik7CiAgICAgIC8vIGNiKGltYWdlVXJsLCAiZGVzY3JpcHRpb24iKTsKCiAgICAgIHRoaXMuJGVtaXQoJ2NhbGxiYWNrLXVwbG9hZCcsIGZpbGVPckJsb2IpOwoKICAgICAgLy8gdGhpcy51cGxvYWRGdW5jdGlvbihmaWxlT3JCbG9iKS50aGVuKHJlcyA9PiB7CiAgICAgIC8vCiAgICAgIC8vICAgY29uc3QgeyB1cmwsIGRlc2MgfSA9IHJlczsKICAgICAgLy8gICB0aGlzLmh0bWwgKz0gYDxwPjxpbWcgc3JjPSIke3RoaXMuQVRUQUNIX1BBVEggKyB1cmx9IiBhbHQ9IiR7ZGVzY30iLz48L3A+YAogICAgICAvLyAgIHRoaXMuJHJlZnMudGVkaXRvcj8uaW52b2tlKCJzZXRIdG1sIiwgdGhpcy5odG1sID8/ICcnKTsKICAgICAgLy8KICAgICAgLy8gICBjb25zb2xlLmxvZyhjYik7CiAgICAgIC8vICAgY29uc29sZS5sb2coc291cmNlKTsKICAgICAgLy8gICAvLyBjYih0aGlzLkFUVEFDSF9QQVRIICsgdXJsLCAiZGVzY3JpcHRpb24iKTsKICAgICAgLy8gfSk7CiAgICB9LAogICAgdXBsb2FkQ29tcGxldGUoKSB7CiAgICAgIGlmKHRoaXMuZWRpdG9yTW9kZSkKICAgICAgICB0aGlzLmh0bWwgPSB0aGlzLmdldEVkaXRvckh0bWwoKTsKCiAgICAgIHRoaXMuaHRtbCArPSBgPHA+PGltZyBzcmM9IiR7dGhpcy5BVFRBQ0hfUEFUSH0ke3RoaXMudXBsb2FkZWQuY29udGV4dFBhdGh9JHt0aGlzLnVwbG9hZGVkLnNhdmVOYW1lfSIgYWx0PSIke3RoaXMudXBsb2FkZWQuY2xpZW50TmFtZX0iLz48L3A+YAogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy4kcmVmcy50ZWRpdG9yPy5pbnZva2UoInNldEh0bWwiLCB0aGlzLmh0bWwsIGZhbHNlKTsKICAgICAgfSk7CiAgICAgIC8vIHRoaXMuJHJlZnMudGVkaXRvcj8uaW52b2tlKCJzZXRIdG1sIiwgdGhpcy5odG1sID8/ICcnKTsKICAgIH0sCiAgICBlbmFibGVIdG1sTW9kZSgpIHsKICAgICAgaWYoIXRoaXMuZWRpdG9yTW9kZSkKICAgICAgICByZXR1cm4KCiAgICAgIC8vIGNvbnNvbGUubG9nKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoInR1aS1lZGl0b3ItY29udGVudHMiKVswXS5pbm5lckhUTUwpOwogICAgICAvLyBjb25zb2xlLmxvZyhkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJ0dWktZWRpdG9yLWNvbnRlbnRzIilbMF0pOwoKCiAgICAgIC8vIGZvciAodmFyIGkgPSAwOyBpIDwgZWRpdG9yQ29udGVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgLy8gICBjb25zb2xlLmxvZyhlZGl0b3JDb250ZW50c1tpXS5pbm5lckhUTUwpOwogICAgICAvLyB9CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAvLyB0aGlzLiRlbWl0KCdjYWxsYmFjay1odG1sJywgdGhpcy4kcmVmcy50ZWRpdG9yLmludm9rZSgiZ2V0SHRtbCIpKTsKICAgICAgICAvLyB0aGlzLmh0bWwgPSB0aGlzLiRyZWZzLnRlZGl0b3IuaW52b2tlKCJnZXRIdG1sIik7CiAgICAgICAgLy8gdGhpcy5odG1sID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgidHVpLWVkaXRvci1jb250ZW50cyIpWzBdOwogICAgICAgIC8vIGNvbnNvbGUubG9nKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3RlLXd3LWNvbnRhaW5lcicpWzBdPy5jaGlsZE5vZGVzWzBdPy5jaGlsZE5vZGVzPz8nJyk7CiAgICAgICAgLy8gY29uc29sZS5sb2coWy4uLmVkaXRvckNvbnRlbnRzXS5tYXAoYyA9PiBjLmlubmVySFRNTCkpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKGVkaXRvckNvbnRlbnRzKTsKCiAgICAgICAgdGhpcy5odG1sID0gYmVhdXRpZnlfaHRtbCh0aGlzLmdldEVkaXRvckh0bWwoKSk7CiAgICAgICAgY29uc29sZS5sb2codGhpcy5odG1sKQogICAgICB9KTsKICAgICAgdGhpcy5lZGl0b3JNb2RlID0gZmFsc2U7CgogICAgfSwKICAgIGRpc2FibGVIdG1sTW9kZSgpIHsKICAgICAgaWYodGhpcy5lZGl0b3JNb2RlKQogICAgICAgIHJldHVybgoKICAgICAgLy8gdGhpcy4kZW1pdCgnY2FsbGJhY2stZWRpdG9yJyk7CgogICAgICB0aGlzLmVkaXRvck1vZGUgPSB0cnVlOwoKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnM/LnRlZGl0b3I/Lmludm9rZSgic2V0SHRtbCIsIHRoaXMuaHRtbCwgZmFsc2UpOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRWYWx1ZSgpIHsKICAgICAgaWYodGhpcy5lZGl0b3JNb2RlKQogICAgICAgIHRoaXMuaHRtbCA9IHRoaXMuZ2V0RWRpdG9ySHRtbCgpOwogICAgICByZXR1cm4gdGhpcy5odG1sOwogICAgICAvLyByZXR1cm4gdGhpcy5lZGl0b3JNb2RlID8gdGhpcy4kcmVmcy50ZWRpdG9yLmludm9rZSgiZ2V0SHRtbCIpIDogdGhpcy5odG1sOwogICAgfSwKICAgIGdldEVkaXRvckh0bWwoKSB7CiAgICAgIHJldHVybiBbLi4uZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgndGUtd3ctY29udGFpbmVyJylbMF0/LmNoaWxkTm9kZXNbMF0/LmNoaWxkTm9kZXMgPz8gW11dLmZpbHRlcihjID0+IGMuY2xhc3NOYW1lLmluZGV4T2YoInR1aS1lZGl0b3ItY29udGVudHMiKSAhPT0gLTEpPy5bMF0/LmlubmVySFRNTCA/PyAnJzsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICB2YWw6IGZ1bmN0aW9uKHYpIHsKICAgICAgdGhpcy5odG1sID0gXy5jbG9uZURlZXAodik7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLiRyZWZzLnRlZGl0b3I/Lmludm9rZSgic2V0SHRtbCIsIHRoaXMuaHRtbCA/PyAnJyk7CiAgICAgIH0pOwogICAgICB0aGlzLmVkaXRvck1vZGUgPSB0cnVlOwogICAgfSwKICAgIHVwbG9hZGVkOiBmdW5jdGlvbih2KSB7CiAgICAgIGlmKHYgJiYgT2JqZWN0LmtleXModikubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMudXBsb2FkQ29tcGxldGUoKTsKICAgICAgfQogICAgfQogIH0sCiAgZGF0YTogKCkgPT4gKHsKICAgIEFUVEFDSF9QQVRIOnByb2Nlc3MuZW52LlZVRV9BUFBfQVRUQUNIX0ZJTEVfU0VSVkVSX1VSTCwKICAgIGVkaXRvck9wdGlvbnM6ewogICAgICBtaW5IZWlnaHQ6ICcyMDBweCcsCiAgICAgIGxhbmd1YWdlOiAnZW5fVVMnLAogICAgICB1c2VDb21tYW5kU2hvcnRjdXQ6IHRydWUsCiAgICAgIHVzZURlZmF1bHRIVE1MU2FuaXRpemVyOiB0cnVlLAogICAgICB1c2FnZVN0YXRpc3RpY3M6IHRydWUsCiAgICAgIGhpZGVNb2RlU3dpdGNoOiBmYWxzZSwKICAgICAgcHJldmlld1N0eWxlOiAndmVydGljYWwnLAogICAgICB0b29sYmFySXRlbXM6IFsKICAgICAgICAnaGVhZGluZycsCiAgICAgICAgJ2JvbGQnLAogICAgICAgICdpdGFsaWMnLAogICAgICAgICdzdHJpa2UnLAogICAgICAgICdkaXZpZGVyJywKICAgICAgICAnaHInLAogICAgICAgICdxdW90ZScsCiAgICAgICAgJ2RpdmlkZXInLAogICAgICAgICd1bCcsCiAgICAgICAgJ29sJywKICAgICAgICAndGFzaycsCiAgICAgICAgJ2luZGVudCcsCiAgICAgICAgJ291dGRlbnQnLAogICAgICAgICdkaXZpZGVyJywKICAgICAgICAndGFibGUnLAogICAgICAgICdpbWFnZScsCiAgICAgICAgJ2xpbmsnLAogICAgICAgICdkaXZpZGVyJywKICAgICAgICAnY29kZScsCiAgICAgICAgJ2NvZGVibG9jaycKICAgICAgXQogICAgfSwKICAgIGh0bWw6JycsCiAgICBydWxlczogewogICAgICByZXF1aXJlZDogdmFsdWUgPT4gISF2YWx1ZSB8fCAn7ZWE7IiYIOyeheugpSDtla3rqqnsnoXri4jri6QuLicKICAgIH0sCiAgICBlZGl0b3JNb2RlOiB0cnVlCiAgfSkKfQo="},{"version":3,"sources":["EditorComponent.vue"],"names":[],"mappings":";AAyBA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EditorComponent.vue","sourceRoot":"src/components/editor","sourcesContent":["<template>\n<section>\n  <v-row>\n    <v-col class=\"mgr\" >\n      <v-card-actions>\n        <v-spacer></v-spacer>\n        <v-btn color=\"blue darken-1\" text @click=\"enableHtmlMode\">HTML</v-btn>\n        <v-btn color=\"blue darken-1\" text @click=\"disableHtmlMode\">EDITOR</v-btn>\n      </v-card-actions>\n    </v-col>\n  </v-row>\n  <v-row v-if=\"editorMode\">\n    <v-col class=\"mgr\">\n      <editor ref=\"teditor\" :options=\"editorComputedOptions()\" initialEditType=\"wysiwyg\"/>\n    </v-col>\n  </v-row>\n  <v-row  v-else>\n    <v-col class=\"mgr\">\n      <v-textarea v-model=\"html\" :rules=\"[rules.required]\" :label=\"label\" :auto-grow=\"false\" rows=\"10\"></v-textarea>\n    </v-col>\n  </v-row>\n</section>\n</template>\n\n<script>\nimport '@toast-ui/editor/dist/toastui-editor.css';\nimport 'codemirror/lib/codemirror.css';\nimport 'tui-color-picker/dist/tui-color-picker.css';\nimport colorSyntax from '@toast-ui/editor-plugin-color-syntax';\n\nimport {Editor} from '@toast-ui/vue-editor';\nimport _ from 'lodash';\n\nconst beautify_html = require('js-beautify').html;\n\nexport default {\n  name: \"EditorComponent\",\n  components: {\n    Editor\n  },\n  props: {\n    val:String,\n    label:{\n      type:String,\n      default:\"컨텐츠 내용\"\n    },\n    uploaded: Object\n  },\n  methods: {\n    editorComputedOptions() {\n      const _this = this;\n      const options = Object.assign({}, this.editorOptions, this.options);\n      options.hooks = {};\n      options.initialEditType = _this.mode;\n      options.height = _this.height;\n      options.language = _this.language;\n      options.placeholder = _this.placeholder;\n      options.hooks.addImageBlobHook = _this.uploadImage;\n      options.plugins = [colorSyntax]\n\n      return options;\n    },\n    // uploadImage(fileOrBlob, cb, source) {\n    uploadImage(fileOrBlob) {\n      // let imageUrl = URL.createObjectURL(fileOrBlob);\n      // cb(imageUrl, \"description\");\n\n      this.$emit('callback-upload', fileOrBlob);\n\n      // this.uploadFunction(fileOrBlob).then(res => {\n      //\n      //   const { url, desc } = res;\n      //   this.html += `<p><img src=\"${this.ATTACH_PATH + url}\" alt=\"${desc}\"/></p>`\n      //   this.$refs.teditor?.invoke(\"setHtml\", this.html ?? '');\n      //\n      //   console.log(cb);\n      //   console.log(source);\n      //   // cb(this.ATTACH_PATH + url, \"description\");\n      // });\n    },\n    uploadComplete() {\n      if(this.editorMode)\n        this.html = this.getEditorHtml();\n\n      this.html += `<p><img src=\"${this.ATTACH_PATH}${this.uploaded.contextPath}${this.uploaded.saveName}\" alt=\"${this.uploaded.clientName}\"/></p>`\n      this.$nextTick(() => {\n        this.$refs.teditor?.invoke(\"setHtml\", this.html, false);\n      });\n      // this.$refs.teditor?.invoke(\"setHtml\", this.html ?? '');\n    },\n    enableHtmlMode() {\n      if(!this.editorMode)\n        return\n\n      // console.log(document.getElementsByClassName(\"tui-editor-contents\")[0].innerHTML);\n      // console.log(document.getElementsByClassName(\"tui-editor-contents\")[0]);\n\n\n      // for (var i = 0; i < editorContents.length; i++) {\n      //   console.log(editorContents[i].innerHTML);\n      // }\n      this.$nextTick(() => {\n        // this.$emit('callback-html', this.$refs.teditor.invoke(\"getHtml\"));\n        // this.html = this.$refs.teditor.invoke(\"getHtml\");\n        // this.html = document.getElementsByClassName(\"tui-editor-contents\")[0];\n        // console.log(document.getElementsByClassName('te-ww-container')[0]?.childNodes[0]?.childNodes??'');\n        // console.log([...editorContents].map(c => c.innerHTML));\n        // console.log(editorContents);\n\n        this.html = beautify_html(this.getEditorHtml());\n        console.log(this.html)\n      });\n      this.editorMode = false;\n\n    },\n    disableHtmlMode() {\n      if(this.editorMode)\n        return\n\n      // this.$emit('callback-editor');\n\n      this.editorMode = true;\n\n      this.$nextTick(() => {\n        this.$refs?.teditor?.invoke(\"setHtml\", this.html, false);\n      });\n    },\n    getValue() {\n      if(this.editorMode)\n        this.html = this.getEditorHtml();\n      return this.html;\n      // return this.editorMode ? this.$refs.teditor.invoke(\"getHtml\") : this.html;\n    },\n    getEditorHtml() {\n      return [...document.getElementsByClassName('te-ww-container')[0]?.childNodes[0]?.childNodes ?? []].filter(c => c.className.indexOf(\"tui-editor-contents\") !== -1)?.[0]?.innerHTML ?? '';\n    }\n  },\n  watch: {\n    val: function(v) {\n      this.html = _.cloneDeep(v);\n      this.$nextTick(() => {\n        this.$refs.teditor?.invoke(\"setHtml\", this.html ?? '');\n      });\n      this.editorMode = true;\n    },\n    uploaded: function(v) {\n      if(v && Object.keys(v).length > 0) {\n        this.uploadComplete();\n      }\n    }\n  },\n  data: () => ({\n    ATTACH_PATH:process.env.VUE_APP_ATTACH_FILE_SERVER_URL,\n    editorOptions:{\n      minHeight: '200px',\n      language: 'en_US',\n      useCommandShortcut: true,\n      useDefaultHTMLSanitizer: true,\n      usageStatistics: true,\n      hideModeSwitch: false,\n      previewStyle: 'vertical',\n      toolbarItems: [\n        'heading',\n        'bold',\n        'italic',\n        'strike',\n        'divider',\n        'hr',\n        'quote',\n        'divider',\n        'ul',\n        'ol',\n        'task',\n        'indent',\n        'outdent',\n        'divider',\n        'table',\n        'image',\n        'link',\n        'divider',\n        'code',\n        'codeblock'\n      ]\n    },\n    html:'',\n    rules: {\n      required: value => !!value || '필수 입력 항목입니다..'\n    },\n    editorMode: true\n  })\n}\n</script>\n<style>\ndiv.tui-popup-wrapper.te-popup-add-image.tui-editor-popup > div.tui-popup-body > .te-file-type.te-tab-active + label {\n  display: none;\n}\ndiv.tui-popup-wrapper.te-popup-add-image.tui-editor-popup > div.tui-popup-body > .te-file-type.te-tab-active + label + input {\n  display: none;\n}\n.tui-editor-popup .tui-popup-body input[type='text'], .tui-editor-popup .tui-popup-body input[type='file'] {\n  color: #111b27;\n}\n</style>\n<style scoped>\n</style>\n"]}]}